!function(f){var v={drawCircle:function(t,e,n,o){return null!=t.circle&&t.circle.setMap(null),0<n?(n*=1,(o=f.extend({strokeColor:"#0000FF",strokeOpacity:.35,strokeWeight:2,fillColor:"#0000FF",fillOpacity:.2},o)).map=t.map,o.radius=n,o.center=e,t.circle=new google.maps.Circle(o),t.circle):null},setPosition:function(t,e,n){t.location=e,t.marker.setPosition(e),t.map.panTo(e),this.drawCircle(t,e,t.radius,{}),t.settings.enableReverseGeocode?this.updateLocationName(t,n):n&&n.call(this,t)},locationFromLatLng:function(t){return{latitude:t.lat(),longitude:t.lng()}},addressByFormat:function(t,e){for(var n=null,o=t.length-1;0<=o;o--)0<=t[o].types.indexOf(e)&&(n=t[o]);return n||t[0]},updateLocationName:function(o,a){o.geodecoder.geocode({latLng:o.marker.position},function(t,e){if(e==google.maps.GeocoderStatus.OK&&0<t.length){var n=v.addressByFormat(t,o.settings.addressFormat);o.locationName=n.formatted_address,o.addressComponents=v.address_component_from_google_geocode(n.address_components)}else if(e==google.maps.GeocoderStatus.OVER_QUERY_LIMIT)return setTimeout(function(){v.updateLocationName(o,a)},1e3);a&&a.call(this,o)})},address_component_from_google_geocode:function(t){for(var e={},n=t.length-1;0<=n;n--){var o=t[n];0<=o.types.indexOf("postal_code")?e.postalCode=o.short_name:0<=o.types.indexOf("street_number")?e.streetNumber=o.short_name:0<=o.types.indexOf("route")?e.streetName=o.short_name:0<=o.types.indexOf("locality")?e.city=o.short_name:0<=o.types.indexOf("sublocality")?e.district=o.short_name:0<=o.types.indexOf("administrative_area_level_1")?e.stateOrProvince=o.short_name:0<=o.types.indexOf("country")&&(e.country=o.short_name)}return e.addressLine1=[e.streetNumber,e.streetName].join(" ").trim(),e.addressLine2="",e}};function h(t){return null!=L(t)}function L(t){return f(t).data("locationpicker")}function k(t,e){if(t){var n=v.locationFromLatLng(e.marker.position);t.latitudeInput&&t.latitudeInput.val(n.latitude).change(),t.longitudeInput&&t.longitudeInput.val(n.longitude).change(),t.radiusInput&&t.radiusInput.val(e.radius).change(),t.locationNameInput&&t.locationNameInput.val(e.locationName).change()}}function y(n,o){if(n){if(n.radiusInput&&n.radiusInput.on("change",function(t){var e=f(this).val();t.originalEvent&&!isNaN(e)&&(o.radius=e,v.setPosition(o,o.location,function(t){t.settings.onchanged.apply(o.domContainer,[v.locationFromLatLng(t.location),t.radius,!1])}))}),n.locationNameInput&&o.settings.enableAutocomplete){var e=!1;o.autocomplete=new google.maps.places.Autocomplete(n.locationNameInput.get(0),o.settings.autocompleteOptions),google.maps.event.addListener(o.autocomplete,"place_changed",function(){e=!1;var t=o.autocomplete.getPlace();t.geometry?v.setPosition(o,t.geometry.location,function(t){k(n,t),t.settings.onchanged.apply(o.domContainer,[v.locationFromLatLng(t.location),t.radius,!1])}):o.settings.onlocationnotfound(t.name)}),o.settings.enableAutocompleteBlur&&(n.locationNameInput.on("change",function(t){t.originalEvent&&(e=!0)}),n.locationNameInput.on("blur",function(t){t.originalEvent&&setTimeout(function(){var t=f(n.locationNameInput).val();5<t.length&&e&&(e=!1,o.geodecoder.geocode({address:t},function(t,e){e==google.maps.GeocoderStatus.OK&&t&&t.length&&v.setPosition(o,t[0].geometry.location,function(t){k(n,t),t.settings.onchanged.apply(o.domContainer,[v.locationFromLatLng(t.location),t.radius,!1])})}))},1e3)}))}n.latitudeInput&&n.latitudeInput.on("change",function(t){var e=f(this).val();t.originalEvent&&!isNaN(e)&&v.setPosition(o,new google.maps.LatLng(e,o.location.lng()),function(t){t.settings.onchanged.apply(o.domContainer,[v.locationFromLatLng(t.location),t.radius,!1]),k(o.settings.inputBinding,o)})}),n.longitudeInput&&n.longitudeInput.on("change",function(t){var e=f(this).val();t.originalEvent&&!isNaN(e)&&v.setPosition(o,new google.maps.LatLng(o.location.lat(),e),function(t){t.settings.onchanged.apply(o.domContainer,[v.locationFromLatLng(t.location),t.radius,!1]),k(o.settings.inputBinding,o)})})}}f.fn.locationpicker=function(p,t){if("string"==typeof p){var e=this.get(0);if(!h(e))return;var n=L(e);switch(p){case"location":if(null==t){var o=v.locationFromLatLng(n.location);return o.radius=n.radius,o.name=n.locationName,o}t.radius&&(n.radius=t.radius),v.setPosition(n,new google.maps.LatLng(t.latitude,t.longitude),function(t){k(t.settings.inputBinding,t)});break;case"subscribe":if(null==t)return null;var a=t.event,i=t.callback;if(!a||!i)return console.error('LocationPicker: Invalid arguments for method "subscribe"'),null;google.maps.event.addListener(n.map,a,i);break;case"map":if(null==t){var r=v.locationFromLatLng(n.location);return r.formattedAddress=n.locationName,r.addressComponents=n.addressComponents,{map:n.map,marker:n.marker,location:r}}return null;case"autosize":return s=n,google.maps.event.trigger(s.map,"resize"),setTimeout(function(){s.map.setCenter(s.marker.position)},300),this}return null}var s;return this.each(function(){var e,n,t,o,a,i,r,s,l,u,c=f(this);if(h(this))return e=L(this),n=f(this),t=p,o=f.extend({},f.fn.locationpicker.defaults,t),a=o.location.latitude,i=o.location.longitude,r=o.radius,s=e.settings.location.latitude,l=e.settings.location.longitude,u=e.settings.radius,void(a==s&&i==l&&r==u||(e.settings.location.latitude=a,e.settings.location.longitude=i,e.radius=r,v.setPosition(e,new google.maps.LatLng(e.settings.location.latitude,e.settings.location.longitude),function(t){y(e.settings.inputBinding,e),t.settings.oninitialized(n)})));var d=f.extend({},f.fn.locationpicker.defaults,p),g=new function(t,e){var n=new google.maps.Map(t,e),o=new google.maps.Marker({position:new google.maps.LatLng(54.19335,-3.92695),map:n,title:"Drag Me",visible:e.markerVisible,draggable:e.markerDraggable,icon:void 0!==e.markerIcon?e.markerIcon:void 0});return{map:n,marker:o,circle:null,location:o.position,radius:e.radius,locationName:e.locationName,addressComponents:{formatted_address:null,addressLine1:null,addressLine2:null,streetName:null,streetNumber:null,city:null,district:null,state:null,stateOrProvince:null},settings:e.settings,domContainer:t,geodecoder:new google.maps.Geocoder}}(this,f.extend({},{zoom:d.zoom,center:new google.maps.LatLng(d.location.latitude,d.location.longitude),mapTypeId:d.mapTypeId,mapTypeControl:!1,styles:d.styles,disableDoubleClickZoom:!1,scrollwheel:d.scrollwheel,streetViewControl:!1,radius:d.radius,locationName:d.locationName,settings:d,autocompleteOptions:d.autocompleteOptions,addressFormat:d.addressFormat,draggable:d.draggable,markerIcon:d.markerIcon,markerDraggable:d.markerDraggable,markerVisible:d.markerVisible},d.mapOptions));function m(){v.setPosition(g,g.marker.position,function(t){var e=v.locationFromLatLng(g.location);k(g.settings.inputBinding,g),t.settings.onchanged.apply(g.domContainer,[e,t.radius,!0])})}c.data("locationpicker",g),d.markerInCenter&&(g.map.addListener("bounds_changed",function(){g.marker.dragging||(g.marker.setPosition(g.map.center),k(g.settings.inputBinding,g))}),g.map.addListener("idle",function(){g.marker.dragging||m()})),google.maps.event.addListener(g.marker,"drag",function(t){k(g.settings.inputBinding,g)}),google.maps.event.addListener(g.marker,"dragend",function(t){m()}),v.setPosition(g,new google.maps.LatLng(d.location.latitude,d.location.longitude),function(t){k(d.inputBinding,g),y(d.inputBinding,g),t.settings.oninitialized(c)})})},f.fn.locationpicker.defaults={location:{latitude:40.7324319,longitude:-73.82480777777776},locationName:"",radius:500,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[],mapOptions:{},scrollwheel:!0,inputBinding:{latitudeInput:null,longitudeInput:null,radiusInput:null,locationNameInput:null},enableAutocomplete:!1,enableAutocompleteBlur:!1,autocompleteOptions:null,addressFormat:"postal_code",enableReverseGeocode:!0,draggable:!0,onchanged:function(t,e,n){},onlocationnotfound:function(t){},oninitialized:function(t){},markerIcon:void 0,markerDraggable:!0,markerVisible:!0}}(jQuery);