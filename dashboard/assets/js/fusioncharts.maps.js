!function(t){"object"==typeof module&&void 0!==module.exports?module.exports=t:t(FusionCharts)}(function(K){K.register("module",["private","modules.renderer.js-kdtree",function(){function e(t){function c(t,e,o){var r=t[e];t[e]=t[o],t[o]=r}var e,m=t&&t[0]&&t[0].r||5,d=Math.max,p=Math.floor,v=Math.sqrt,g=Math.min,u=Math.log,f=Math.exp,b=Math.pow;for(e=(t=t||[]).length;e--;)t[e].r>m&&(m=t[e].r),t[e].i=e,t[e].x=+t[e].x,t[e].y=+t[e].y;return{tree:0===t.length?{}:function t(e,o,r,a){var i,n={};return i=a?"y":"x",o===r?n.point=e[o]:1==r-o?e[o][i]>e[r][i]?(n.point=e[o],n.left={point:e[r]}):(n.point=e[r],n.left={point:e[o]}):(i=o+r>>1,a?function t(e,o,r,a){for(var i,n,l,s,h;r<a;){for(600<a-r&&(n=o-r+1,l=u(i=a-r+1),s=.5*f(2*l/3),h=.5*v(l*s*(i-s)/i)*(n-i/2<0?-1:1),l=d(r,p(o-n*s/i+h)),i=g(a,p(o+(i-n)*s/i+h)),t(e,o,l,i)),i=e[o],s=a,c(e,n=r,o),e[a].y>i.y&&c(e,r,a);n<s;){for(c(e,n,s),n++,s--;e[n].y<i.y;)n++;for(;e[s].y>i.y;)s--}e[r].y===i.y?c(e,r,s):c(e,++s,a),s<=o&&(r=s+1),o<=s&&(a=s-1)}}(e,i,o,r):function t(e,o,r,a){for(var i,n,l,s,h;r<a;){for(600<a-r&&(n=o-r+1,l=u(i=a-r+1),s=.5*f(2*l/3),h=.5*v(l*s*(i-s)/i)*(n-i/2<0?-1:1),l=d(r,p(o-n*s/i+h)),i=g(a,p(o+(i-n)*s/i+h)),t(e,o,l,i)),i=e[o],s=a,c(e,n=r,o),e[a].x>i.x&&c(e,r,a);n<s;){for(c(e,n,s),n++,s--;e[n].x<i.x;)n++;for(;e[s].x>i.x;)s--}e[r].x===i.x?c(e,r,s):c(e,++s,a),s<=o&&(r=s+1),o<=s&&(a=s-1)}}(e,i,o,r),n.point=e[i],n.left=t(e,o,i-1,!a),n.right=t(e,i+1,r,!a)),n}(t,0,t.length-1,!1),search:function(r,a,o){function e(t,e){return"circle"===o?v(b(t-r,2)+b(e-a,2))<=c:c<=t&&t<=d&&p<=e&&e<=g}function i(t){var e,o=r>=t.x1&&r<=t.x2&&a>=t.y1&&a<=t.y2;e=t.point.y,e=v(b(r-t.point.x,2)+b(a-e,2)),h?o?u?t.point.i>h.point.i&&(h=t,u=o,f=e):(h=t,u=o,f=e):!u&&e<f&&(h=t,u=o,f=e):(h=t,u=o,f=e)}function n(t){"circle"===o?c=t:(c=r-t||0,d=r+t||0,p=a-t||0,g=a+t||0)}function l(t){t&&t.point&&(n(t.point.r),e(t.point.x,t.point.y)&&i(t),c<=t.point.x&&s(t.left),d>=t.point.x&&s(t.right))}function s(t){t&&t.point&&(n(t.point.r),e(t.point.x,t.point.y)&&i(t),p<=t.point.y&&l(t.left),g>=t.point.y&&l(t.right))}var h,c=r-m,d=r+m,p=a-m,g=a+m,u=!1,f=0;return l(this.tree),h&&h.point||h}}}function t(t){this.configure(t)}var o=this.hcLib,L=function(t,e,o,r,a){return Math.pow(o-t,2)+Math.pow(r-e,2)<=Math.pow(a,2)},A=Math.PI,F=Math.cos,E=Math.sin,n=Math.max,l=Math.min,I=A/180,T=function(t,e,o,r,a,i){return o<=n(t,a)&&o>=l(t,a)&&r<=n(e,i)&&r>=l(e,i)},R=function(t,e,o,r,a,i){return e=(r-e)*(a-o),t=(o-t)*(i-r),isNaN(e)&&(e=0),isNaN(t)&&(t=0),0===(t=e-t)?0:0<t?1:2};(t.prototype={configure:function(t){this.validatorFn=t?this.shapeValidator():this.defaultValidator()},defaultValidator:function(){var o=this;return function(t){var e=o.mousePoint;return!!(t&&Math.pow((t.x-e.x)/o.xLimit,2)+Math.pow((t.y-e.y)/o.yLimit,2)<=1)}},shapeValidator:function(){var _=this;return function(t){var e,o,r=_.mousePoint,a=t&&t.shapeInfo,i=!1,n=r.x;r=r.y;switch(a&&a.type){case"circle":e=a.radius,i=L(n,r,t.x,t.y,e);break;case"arc":i=a.innerradius,e=a.radius,i=!L(n,r,t.x,t.y,i)&&L(n,r,t.x,t.y,e);break;case"polygon":e=a.radius,o=a.startAngle,a=a.sides;t:{i=t.x,t=t.y;var l,s,h,c,d,p,g=0;if(l=!1,L(n,r,i,t,e)&&3<=a){for(p=2*A/a,s=i+e*F(-(l=void 0===o?.5*A:o%360*I)),d=t+e*E(-l),o=0;o<a;o++){var u=s,f=d,m=h=i+e*F(-(l+=p)),v=c=t+e*E(-l),b=n,y=r,k=r,w=R(u,f,m,v,b,y),x=R(u,f,m,v,1/0,k),C=R(b,y,1/0,k,u,f),S=R(b,y,1/0,k,m,v);if(w!==x&&C!==S||0===w&&T(u,f,b,y,m,v)||0===x&&T(u,f,1/0,k,m,v)||0===C&&T(b,y,u,f,1/0,k)||0===S&&T(b,y,m,v,1/0,k)){if(0===R(s,d,n,r,h,c)){i=T(s,d,n,r,h,c);break t}g++}s=h,d=c}l=0!=g%2}i=l}break;case"rect":i=t.x,e=t.y,t=i+(a.width||0),a=e+(a.height||0),i=i<=n&&n<=t&&e<=r&&r<=a;break;case"default":i=!1}return i}},buildKdTree:function(t){return this.kdTree=e(t),this.tree=this.kdTree.tree,this},getNeighbour:function(t,e,o){var r=this.tree,a={x1:t.x-this.xLimit,x2:t.x+this.xLimit,y1:t.y-this.yLimit,y2:t.y+this.yLimit},i=this.validatorFn;return this.mousePoint=t,e?this.kdTree&&this.kdTree.search(t.x,t.y,o):r?this._searchBtwnLimit(a,r,!0,i):void 0},_compair2closest:function(t,e){return!t||t&&e&&e.i>t.i?e:t},_searchBtwnLimit:function(t,e,o,r){var a,i,n=o?t.x1:t.y1,l=o?t.x2:t.y2;if(void 0!==(a=e&&e.point&&e.point[o?"x":"y"]))return r(e.point)&&(i=e.point),n<=a&&e.left&&(i=this._compair2closest(i,this._searchBtwnLimit(t,e.left,!o,r))),a<=l&&e.right&&(i=this._compair2closest(i,this._searchBtwnLimit(t,e.right,!o,r))),i},_setSearchLimit:function(t,e){this.xLimit=t,this.yLimit=e}}).constructor=t,o.KdTree=t}]),K.register("module",["private","modules.renderer.js-gradientlegend",function(){function y(t,e){return function t(e,o){var r,a;for(a in e)N.call(e,a)&&(r=e[a],void 0===o[a]?o[a]=r:"object"==typeof r&&t(r,o[a]))}(t,e),e}function g(t){return D(t||V)||V}function k(t){var e=t.fontSize+"";return e&&(e=e.replace(/(\d+)(px)*/,"$1px"),t.fontSize=e),t}function d(t){return void 0===t||null==t||t!=t}function t(t,e){this.carpet=t,this._componentPool=e}function s(t){this.conf=t,this._id="GL_CARPET",this.compositionsByCategory={},this._lSpace=this.group=this.node=void 0,this.autoRecalculate=!1,this.groupName="fc-gradient-legend",this.moveInstructions={}}function h(){s.apply(this,arguments)}function c(t,e){this.rawText=t,this.conf=e,this._id="GL_CAPTION",this._lSpace=this.bound=this.node=void 0}function p(t,e,o){this.colorRange=t,this.conf=e,this.childTextConf=o,this._id="GL_BODY",this.bound=void 0,this.compositionsByCategory={},this._lSpace=void 0}function u(){p.apply(this,arguments)}function f(t){this.conf=t,this._id="GL_LABELS"}function m(){f.apply(this,arguments)}function v(){f.apply(this,arguments),this._id="GL_VALUES"}function b(){v.apply(this,arguments),this._id="GL_VALUES"}function w(t){this.conf=t,this._id="FL_AXIS",this.markerLine=this.shadow=this.node=void 0,this.compositionsByCategory={}}function x(){w.apply(this,arguments)}function C(t){var e={};this._id="GL_SG1",this.conf=t,e.conf=t,this.extremes=[],this.sliders={},(e.sliderGroup=this).valueRange=[],this.callbacks=[],this.sliders[!1]=new o(!1,e,this._id+"_0"),this.sliders[!0]=new o(!0,e,this._id+"_1")}function o(t,e,o){this.conf=e.conf,this.sliderIndex=t,this.rangeGroup=e.sliderGroup,this._id=o,this.tracker=this.node=void 0,this.currPos=0,this.swing=[]}function S(t,e,o){var r,a,i,n,l,s;for(o=o.components.numberFormatter,this.data=t,this.options=e||{},s=this.mapByPercent=!!t.mapByPercent,this.appender="",a=this.mapByPercent?0:e.min,e=this.mapByPercent?100:e.max,2===t.colorRange.length&&(r=t.colorRange[0],i=t.colorRange[1],(n=r.value=d(r.value)?a:r.value)===(l=i.value=d(i.value)?e:i.value)&&(n=r.value=a,l=i.value=e),r.displayValue=s?n+"%":o.legendValue(n),i.displayValue=s?l+"%":o.legendValue(l)),d(a)&&d(r.value)||d(e)&&d(r.value)||!t.gradient?this._preparationGoneWrong=!0:this._preparationGoneWrong=!1,o=this.colorRange=t.colorRange.sort(function(t,e){return t.value-e.value}),this.valueRatio=void 0,this.values=[],t=0,r=o.length;t<r;t++)this.values.push(o[t].value)}function _(){t.apply(this,arguments)}var L,A,F,e,r,E=this,a=E.hcLib,I=a.pluckNumber,T=a.pluck,n=a.toRaphaelColor,i=a.graphics,R=a.dehashify,P=a.hashify,O=i.convertColor,l=i.RGBtoHex,M=i.HEXtoRGB,B=i.getLightColor,D=i.getValidColor,G="rgba(192,192,192,"+(a.isIE?.002:1e-6)+")",V=a.COLOR_BLACK,N={}.hasOwnProperty,j={};(r={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}}).legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:n({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},r.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:G,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:G,stroke:"#FFFFFF"}}},r.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},L={init:function(t){e=t.chart,F=e.components},setConf:function(t){},legacyDataParser:function(t,e){var o,r,a,i,n,l,s,h,c,d={},p=F.numberFormatter;if(!t)return!1;for(d.mapByPercent=c=!!I(t.mapbypercent,0),o=t.color||[],void 0===t.minvalue&&(t.minvalue=void 0!==e.min?c?0:e.min:0),void 0===t.maxvalue&&(t.maxvalue=void 0!==e.max?c?100:e.max:100),l=!1,a=0,i=o.length;a<i;a++)if(o[a].maxvalue){l=!0;break}for(l||(o=[]),a=t.code,l=d.colorRange=[],d.gradient=!!I(t.gradient,1),o.length?a=g(a):(a?(i=g(a),a=g()):(a=g(),i=B(a,1)),o.push({code:i,maxvalue:t.maxvalue,label:void 0})),function(t){var e,o,r,a=F.numberFormatter;for(e=0,o=t.length;e<o;e++)(r=t[e].maxvalue)&&(t[e].maxvalue=a.getCleanValue(r))}(o),o=o.sort(function(t,e){return t.maxvalue-e.maxvalue}),s=h=t.minvalue&&p.getCleanValue(t.minvalue),h=(void 0!==s||null!==s)&&(c?s+"%":p.legendValue(s)),l.push({code:R(a),value:s,displayValue:h,label:t.startlabel}),a=0,i=o.length;a<i;a++)n=g((r=o[a]).code||r.color),s=h=r.maxvalue,isNaN(parseInt(s,10))||(h=(void 0!==s||null!==s)&&(c?s+"%":p.legendValue(s)),l.push(Object({code:R(n),value:s,displayValue:h,label:r.label||r.displayvalue})));return l[l.length-1].label=t.endlabel||r.label,d},getDefaultConf:function(t){return r[t]}},A=function(r){var a=r.chartInstance.id,h=j[a]||(j[a]={});return function(){function e(){var t,e,o,r,a,i;for(t in h)for(e in o=h[t])if((r=o[e])instanceof Array)for(a=0,i=r.length;a<i;a++)r[a]&&r[a].hide();else r.hide()}var t,o,s={};return s[(t={KEY_RECT:"rect",KEY_TEXT:"text",KEY_GROUP:"group",KEY_CIRCLE:"circle",KEY_PATH:"path"}).KEY_RECT]=function(t){return o.rect(t)},s[t.KEY_TEXT]=function(t,e){return o.text(t,e)},s[t.KEY_GROUP]=function(t,e){return o.group(t,e)},s[t.KEY_CIRCLE]=function(t){return o.circle(t)},s[t.KEY_PATH]=function(t,e){return o.path(t,e)},{init:function(t){o=t,e()},emptyPool:function(){h=j[a]={}},getChart:function(){return r},getComponent:function(t,e,o){var r,a,i,n=h[t],l=0;return n||(n=h[t]={}),(a=n[e])&&!(a instanceof Array)||a instanceof Array&&0<a.length?function(){return o?(i=a[l++])?i.show():a[l]=s[e].apply(this,arguments):a.show()}:function(){return o?(r=n[e]||(n[e]=[]),a=s[e].apply(this,arguments),r.push(a),a.show()):n[e]=s[e].apply(this,arguments)}},hideAll:function(){e()},getKeys:function(){return t}}}()},(t.prototype.constructor=t).prototype.draw=function(t){return t.componentPool=this._componentPool,this.carpet.draw(t)},t.prototype.getLogicalSpace=function(t,e){return t.componentPool=this._componentPool,this.carpet.getLogicalSpace(t,e)},t.prototype.dispose=function(){this.carpet&&this.carpet.group&&this.carpet.group.remove(),this._componentPool.emptyPool()},(s.prototype.constructor=s).prototype.addCompositions=function(t,e){this.compositionsByCategory[e]=t},s.prototype.getBoundingBox=function(t){var e=this.conf,o=t.refSide,r=t.alignment,a=t.refOffset,i=t.x,n=t.y;e=e.width=o*e.spreadFactor;return!r||null!=i||(i=(a+o)/2-e/2),{width:e,height:t.maxOtherSide,x:i,y:n}},s.prototype.getPostCalcDecisions=function(t,e){var o,r=this.conf.padding,a=0;for(o in e)a+=e[o].height||0;t.height=a+2*r.v},s.prototype.getLogicalSpace=function(t,e){var o,r,a,i,n=this._lSpace,l=this.conf.padding,s=this.compositionsByCategory,h={},c=a=0;if(n&&!e)return n.isImpure=!0,n;for(i in(d((n=this._lSpace=r=this.getBoundingBox(t)).x)||d(n.y)||d(n.height)||d(n.width))&&(this.autoRecalculate=!0),(n=y(r,{})).height-=2*l.v,n.width-=2*l.h,n.x+=l.h,n.y+=l.v,s)o=s[i],(l=y(n,{})).y+=a,a=n.height*o.conf.spreadFactor,l.height=a+c,a=o.getLogicalSpace(y(l,{}),t,e),c=l.height-a.height,a=(h[i]=a).height;return this.getPostCalcDecisions(r,h),this._lSpace=r},s.prototype.setupDragging=function(){var o=this.group,r=0,a=0,i=0,n=0;o.css({cursor:"move"}),o.drag(function(t,e){r=e[0],a=e[1],o.attr({transform:"t"+(i+r)+","+(n+a)})},function(){i+=r,n+=a},function(){})},s.prototype.draw=function(t){var e,o,r,a=this.conf,i=this.compositionsByCategory,n=t.paper,l=t.parentGroup,s=t.componentPool,h=s.getChart().get("config","animationObj").duration,c=s.getKeys();for(e in this.getLogicalSpace(t,this.autoRecalculate),o=this._lSpace,r=s.getComponent(this._id,c.KEY_GROUP),this.group=l=r(this.groupName,l),l.attr({opacity:0}),l.animate({opacity:1},h,"easeIn"),r=s.getComponent(this._id,c.KEY_RECT),this.node=r(l).attr(o).css(a.style),i)(s=i[e]).draw(a.captionAlignment,o,{colorRange:t.colorRange,numberFormatter:t.numberFormatter,paper:n,parentLayer:l,smartLabel:t.smartLabel,moveInstructions:this.moveInstructions[e],componentPool:t.componentPool});return a.allowDrag&&this.setupDragging(),this.node},((h.prototype=Object.create(s.prototype)).constructor=h).prototype.getBoundingBox=function(t){var e=this.conf,o=t.refSide,r=t.alignment,a=t.refOffset,i=t.x,n=t.y;e=e.height=o*e.spreadFactor;return!r||null!=n||(n=(a+o)/2-e/2),{width:t.maxOtherSide,height:e,x:i,y:n}},h.prototype.getPostCalcDecisions=function(t,e){var o,r,a=this.conf.padding,i=Number.NEGATIVE_INFINITY,n=this.moveInstructions;for(r in s.prototype.getPostCalcDecisions.apply(this,arguments),e)i=i<(o=e[r].width)?o:i;for(r in t.width=i+2*a.h,e)(a=i-(o=e[r].width))&&(n[r]="t"+a/2+",0")},(c.prototype.constructor=c).LEFT={x:function(t,e){return e.x+t.width/2+2}},c.RIGHT={x:function(t,e){return e.x+e.width-t.width/2-2}},c.CENTER={x:function(t,e){return e.x+e.width/2}},c.prototype.getLogicalSpace=function(t,e,o){var r=this.conf.padding,a=this._lSpace,i=this.rawText,n=e.componentPool.getChart();return a&&!o?(a.isImpure=!0,a):(a=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0,smartText:void 0}},o=e.smartLabel,i?((e=y(t,{})).height-=2*r.v,e.width-=2*r.h,e.x+=r.h,e.y+=r.v,o.useEllipsesOnOverflow(n.config.useEllipsesWhenOverflow),k(n=y(this.conf.style,{})),o.setStyle(this._metaStyle=n),i=o.getSmartText(i,e.width,e.height),e.height=i.height,e.width=i.width,t.height=i.height+2*r.v,t.width=i.width+2*r.h,a.node.smartText=i,a.node.logicArea=e,a.bound=t):a.bound)},c.prototype.draw=function(){var t,e,o,r,a,i,n,l,s=this.conf,h=s.bound||{};return 3<=arguments.length?(r=arguments[0],a=arguments[1],i=arguments[2]):2<=arguments.length&&(r=arguments[0],i=arguments[1]),t=i.parentLayer,l=(n=i.componentPool).getKeys(),e=n.getComponent(this._id,l.KEY_GROUP),this.group=t=e("legend-caption",t).css(s.style),this.getLogicalSpace(a,i),i=(e=this._lSpace).node,o=e.bound,e=n.getComponent(this._id,l.KEY_RECT),this.bound=h=e(t).attr(o).css(h.style),r="string"==typeof r?c[r.toUpperCase()].x(i.smartText,a||i.logicArea):r,e=n.getComponent(this._id,l.KEY_TEXT),this.node=e({},t).attr({text:i.smartText.text,x:r,y:i.logicArea.y+i.smartText.height/2,lineHeight:this._metaStyle.lineHeight,fill:s.style.fill}),{group:t,bound:h,node:this.node}},p.SC_STACK=["LEGEND_LABEL","LEGEND_AXIS","AXIS_VALUE"],p.DARW_STACK=["AXIS_VALUE","LEGEND_AXIS","LEGEND_LABEL"],(p.prototype.constructor=p).prototype.addCompositions=function(t,e){this.compositionsByCategory[e]=t},p.prototype.getCompositionPlotAreaFor=function(o){var r;return r=y(o,{}),function(t,e){return t=t||{},r.y+=t.height||0,r.height=o.height*e,r}},p.prototype.getSpaceTaken=function(t){return t.height},p.prototype.updateEffectivePlotArea=function(t,e,o){var r=this.conf.padding;e.height=o,t.height=o+2*r.v},p.prototype.getLogicalSpace=function(t,e,o){var r,a,i,n,l,s=this._lSpace,h=this.conf.padding,c=this.compositionsByCategory,d=0;if(s&&!o)return s.isImpure=!0,s;for(s=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0}},(a=y(t,{})).height-=2*h.v,a.width-=2*h.h,a.x+=h.h,a.y+=h.v,i=this.getCompositionPlotAreaFor(a),e.colorRange=this.colorRange,n=0,l=p.SC_STACK.length;n<l;n++)(h=c[p.SC_STACK[n]])&&(r=i(r,h.conf.spreadFactor),r=h.getLogicalSpace(y(r,{}),e,o),d+=this.getSpaceTaken(r));return this.updateEffectivePlotArea(t,a,d),s.node.logicArea=a,s.bound=t},p.prototype.draw=function(){var t,e,o,r,a,i,n,l=this.childTextConf,s=this.conf.bound.style||{},h=this.compositionsByCategory;for(3<=arguments.length?(o=arguments[1],a=arguments[2]):2<=arguments.length&&(a=arguments[1]),t=a.parentLayer,i=(r=a.componentPool).getKeys(),this.getLogicalSpace(o,a),o=this._lSpace,l=(n=r.getComponent(this._id,i.KEY_GROUP))("legend-body",t).attr({transform:"t0,0"}).css(l.style),n=r.getComponent(this._id,i.KEY_RECT),this.bound=s=n(l).attr(o.bound).css(s),a.colorRange=this.colorRange,a.parentLayer=l,r=0,i=p.DARW_STACK.length;r<i;r++)(e=h[p.DARW_STACK[r]])&&e.draw(a);return a.moveInstructions&&l.attr({transform:a.moveInstructions}),{bound:s,group:l}},((u.prototype=Object.create(p.prototype)).constructor=u).prototype.getCompositionPlotAreaFor=function(o){var r;return r=y(o,{}),function(t,e){return t=t||{},r.x+=t.width||0,r.width=o.width*e,r}},u.prototype.updateEffectivePlotArea=function(t,e,o){var r=this.conf.padding;e.width=o,t.width=o+2*r.h},u.prototype.getSpaceTaken=function(t){return t.width},(f.prototype.constructor=f).prototype.getEffectivePlotArea=function(t){var e=this.conf.padding;return t.height-=2*e.v,t.width-=2*e.h,t.x+=e.h,t.y+=e.v,this.node=[],t},f.prototype.getLogicalSpace=function(t,e,o){var r,a,i,n,l,s,h,c,d,p,g=this._lSpace,u=this.conf,f=u.padding,m=[],v=0;h=e.componentPool.getChart();var b=[];if(g&&!o)return g.isImpure=!0,g;for(g=e.colorRange,e=e.smartLabel,o=g.getCumulativeValueRatio(),r=g.colorRange,s=(g=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0,smartTexts:[]}}).node.smartTexts,i=y(t,{}),i=this.getEffectivePlotArea(i),e.useEllipsesOnOverflow(h.config.useEllipsesWhenOverflow),u=y(u.style,{}),k(this._metaStyle=u),e.setStyle(u),h=e.getSmartText("W"),a=0,u=r.length;a<u;a++)(n=r[a].label)?(v++,b.push({oriIndex:a,label:n})):s[a]=void 0;if(0===(u=b.length))return{height:0,width:0};for(n=l=1<u?(o[b[u-1].oriIndex]-o[b[0].oriIndex])/2*i.width/100:Math.max(o[b[0].oriIndex],100-o[b[0].oriIndex])/2*i.width/100,(v=e.getSmartText(b[0].label,n,i.height)).x=o[b[0].oriIndex]*i.width/100,a=v.x+v.width,m.push(v.height),s[b[0].oriIndex]=v,(v=e.getSmartText(b[u-1].label,n,i.height)).x=o[b[u-1].oriIndex]*i.width/100,r=v.x-v.width,m.push(v.height),s[b[u-1].oriIndex]=v,d=a,a=1;a<u-1;a++)n=b[a].label,p=b[a].oriIndex,v=void 0,l=a+1===u-1?r:o[b[a+1].oriIndex]*i.width/100,c=o[b[a].oriIndex]*i.width/100,(l=Math.min(c-d,l-c))>2*h.width&&((v=e.getSmartText(n,l,i.height)).x=o[p]*i.width/100,d=l,m.push(v.height)),s[b[a].oriIndex]=v;return m=Math.max.apply(Math,m),i.height=m,t.height=m+2*f.v,g.node.logicArea=i,g.bound=t},f.prototype.draw=function(){var t,e,o,r,a,i,n,l,s,h,c=this.conf;for(e=c.bound&&c.bound.style||{stroke:"none"},2<=arguments.length?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),t=i.parentLayer,i.colorRange.getCumulativeValueRatio(),n=(o=i.componentPool).getKeys(),this.getLogicalSpace(r,i),r=(a=this._lSpace).node.logicArea,i=a.node.smartTexts,t=(h=o.getComponent(this._id,n.KEY_GROUP))("legend-labels",t),h=o.getComponent(this._id,n.KEY_RECT),this.bound=e=h(t).attr(a.bound).css(e),h=o.getComponent(this._id,n.KEY_TEXT,!0),n=0,a=i.length;n<a;n++)(o=i[n])&&(l=r.y+o.height/2,s=n===a-1?r.x+o.x-o.width/2:n?r.x+o.x:r.x+o.x+o.width/2,this.node.push(h({},t).attr({text:o.text,x:s,y:l,lineHeight:this._metaStyle.lineHeight,fill:c.style.fill}).transform("R0")));return{group:t,bound:e,node:this.node}},((m.prototype=Object.create(f.prototype)).constructor=m).prototype.getLogicalSpace=function(t,e,o){var r,a,i,n,l,s,h,c,d,p,g=this._lSpace,u=this.conf,f=u.padding,m=[],v=0;h=e.componentPool.getChart();var b=[];if(g&&!o)return g.isImpure=!0,g;for(g=e.colorRange,e=e.smartLabel,o=g.getCumulativeValueRatio(),r=g.colorRange,s=(g=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0,smartTexts:[]}}).node.smartTexts,i=y(t,{}),i=this.getEffectivePlotArea(i),e.useEllipsesOnOverflow(h.config.useEllipsesWhenOverflow),u=y(u.style,{}),k(this._metaStyle=u),e.setStyle(u),h=e.getSmartText("W"),a=0,u=r.length;a<u;a++)(n=r[a].label)?(v++,b.push({oriIndex:a,label:n})):s[a]=void 0;if(0===(u=b.length))return{height:0,width:0};for(n=l=1<u?(o[b[u-1].oriIndex]-o[b[0].oriIndex])/2*i.height/100:Math.max(o[b[0].oriIndex],100-o[b[0].oriIndex])/2*i.height/100,(v=e.getSmartText(b[0].label,n,i.width)).y=o[b[0].oriIndex]*i.height/100,a=v.y+v.width,m.push(v.height),s[b[0].oriIndex]=v,(v=e.getSmartText(b[u-1].label,n,i.width)).y=o[b[u-1].oriIndex]*i.height/100,r=v.y-v.width,m.push(v.height),s[b[u-1].oriIndex]=v,d=a,a=1;a<u-1;a++)n=b[a].label,p=b[a].oriIndex,v=void 0,l=a+1===u-1?r:o[b[a+1].oriIndex]*i.height/100,c=o[b[a].oriIndex]*i.height/100,(l=Math.min(c-d,l-c))>2*h.width&&((v=e.getSmartText(n,l,i.width)).y=o[p]*i.height/100,d=l,m.push(v.height)),s[b[a].oriIndex]=v;return m=Math.max.apply(Math,m),i.width=m,t.width=m+2*f.v,g.node.logicArea=i,g.bound=t},m.prototype.draw=function(){var t,e,o,r,a,i,n,l,s,h,c=this.conf;for(e=c.bound&&c.bound.style||{stroke:"none"},2<=arguments.length?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),t=i.parentLayer,i.colorRange.getCumulativeValueRatio(),n=(o=i.componentPool).getKeys(),this.getLogicalSpace(r,i),r=(a=this._lSpace).node.logicArea,i=a.node.smartTexts,t=(h=o.getComponent(this._id,n.KEY_GROUP))("legend-labels",t),h=o.getComponent(this._id,n.KEY_RECT),this.bound=e=h(t).attr(a.bound).css(e),h=o.getComponent(this._id,n.KEY_TEXT,!0),n=0,a=i.length;n<a;n++)(o=i[n])&&(l=r.x+o.height/2,s=n===a-1?r.y+o.y-o.width/2:n?r.y+o.y:r.y+o.y+o.width/2,this.node.push(h({},t).attr({text:o.text,x:l,y:s,lineHeight:this._metaStyle.lineHeight,fill:c.style.fill}).transform("R270,"+l+","+s)));return{group:t,bound:e,node:this.node}},((v.prototype=Object.create(f.prototype)).constructor=v).prototype.getLogicalSpace=function(t,e,o){var r,a,i,n,l,s,h,c,d,p,g=this._lSpace,u=this.conf,f=u.padding,m=e.componentPool.getChart(),v=[];if(g&&!o)return g.isImpure=!0,g;for(g=e.colorRange,e=e.smartLabel,o=g.colorRange,i=g.getCumulativeValueRatio(),p=(g=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0,smartTexts:[]}}).node.smartTexts,(c=y(t,{})).height-=2*f.v,c.width-=2*f.h,c.x+=f.h,c.y+=f.v,e.useEllipsesOnOverflow(m.config.useEllipsesWhenOverflow),u=y(u.style,{}),k(this._metaStyle=u),e.setStyle(u),m=e.getSmartText("W"),s=(i[(u=o.length)-1]-i[0])/2*c.width/100,r=o[0].displayValue,(r=e.getSmartText("string"!=typeof r&&void 0!==r&&r.toString()||r,s,c.height)).x=i[0]*c.width/100,a=r.x+r.width,v.push(r.height),p[0]=r,(r=e.getSmartText(o[u-1].displayValue,s,c.height)).x=i[u-1]*c.width/100,s=r.x-r.width,v.push(r.height),p[u-1]=r,h=a,a=1;a<u-1;a++)r=void 0,d=o[a].displayValue,n=a+1===u-1?s:i[a+1]*c.width/100,l=i[a]*c.width/100,(n=Math.min(l-h,n-l))>1.5*m.width&&((r=e.getSmartText(d,2*n,c.height)).x=i[a]*c.width/100,h=n,v.push(r.height)),p[a]=r;return v=Math.max.apply(Math,v),c.height=v,t.height=v+2*f.v,g.node.logicArea=c,g.bound=t},v.prototype.draw=function(){var t,e,o,r,a,i,n,l,s,h=this.conf,c=h.bound&&h.bound.style||{stroke:"none"};for(2<=arguments.length?(a=arguments[0],n=arguments[1]):1<=arguments.length&&(n=arguments[0]),r=n.parentLayer,e=n.colorRange.getCumulativeValueRatio(),t=(o=n.componentPool).getKeys(),this.getLogicalSpace(a,n),a=(i=this._lSpace).node.logicArea,n=i.node.smartTexts,r=(s=o.getComponent(this._id,t.KEY_GROUP))("legend-values",r),s=o.getComponent(this._id,t.KEY_RECT),this.bound=c=s(r).attr(i.bound).css(c),s=o.getComponent(this._id,t.KEY_TEXT,!0),t=0,i=e.length;t<i;t++)(l=n[t])&&(e=a.y+l.height/2,o=t===i-1?a.x+l.x-l.width/2:t?a.x+l.x:a.x+l.x+l.width/2,s({},r).attr({text:l.text,x:o,y:e,lineHeight:this._metaStyle.lineHeight,fill:h.style.fill}));return{group:r,bound:c}},((b.prototype=Object.create(v.prototype)).constructor=b).prototype.getLogicalSpace=function(t,e,o){var r,a,i,n,l,s,h,c,d,p,g=this._lSpace,u=this.conf,f=u.padding,m=e.componentPool.getChart(),v=[];if(g&&!o)return g.isImpure=!0,g;for(g=e.colorRange,e=e.smartLabel,o=g.colorRange,a=g.getCumulativeValueRatio(),p=(g=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0,smartTexts:[]}}).node.smartTexts,(l=y(t,{})).height-=2*f.v,l.width-=2*f.h,l.x+=f.h,l.y+=f.v,e.useEllipsesOnOverflow(m.config.useEllipsesWhenOverflow),k(u=y(u.style,{})),e.setStyle(this._metaStyle=u),d=e.getSmartText("W"),s=(a[(m=o.length)-1]-a[0])/2*l.height/100,(u=e.getSmartText(o[0].displayValue,l.width,s)).y=a[0]*l.height/100,r=u.y+u.width,v.push(u.width),p[0]=u,(u=e.getSmartText(o[m-1].displayValue,l.width,s)).y=a[m-1]*l.height/100,s=u.y-u.height,v.push(u.width),p[m-1]=u,h=r,r=1;r<m-1;r++)u=void 0,c=o[r].displayValue,i=r+1===m-1?s:a[r+1]*l.height/100,n=a[r]*l.height/100,(i=Math.min(n-h,i-n))>2*d.height&&((u=e.getSmartText(c,l.width,2*i)).y=a[r]*l.height/100,h=i,v.push(u.width)),p[r]=u;return v=Math.max.apply(Math,v),l.width=v,t.width=v+2*f.h,g.node.logicArea=l,g.bound=t},b.prototype.draw=function(){var t,e,o,r,a,i,n,l,s,h,c=this.conf;for(e=c.bound&&c.bound.style||{stroke:"none"},2<=arguments.length?(o=arguments[0],a=arguments[1]):1<=arguments.length&&(a=arguments[0]),t=a.parentLayer,i=a.colorRange.getCumulativeValueRatio(),l=(n=a.componentPool).getKeys(),this.getLogicalSpace(o,a),o=(r=this._lSpace).node.logicArea,a=r.node.smartTexts,t=(h=n.getComponent(this._id,l.KEY_GROUP))("legend-values",t),h=n.getComponent(this._id,l.KEY_RECT),this.bound=e=h(t).attr(r.bound).css(e),h=n.getComponent(this._id,l.KEY_TEXT,!0),n=0,l=i.length;n<l;n++)(i=a[n])&&(r=o.x+i.width/2,s=n===l-1?o.y+i.y-i.height/2:n?o.y+i.y:o.y+i.y+i.height/2,h({},t).attr({text:i.text,x:r,y:s,lineHeight:this._metaStyle.lineHeight,fill:c.style.fill}));return{group:t,bound:e}},(w.prototype.constructor=w).prototype.addCompositions=function(t,e){this.compositionsByCategory[e]=t},w.prototype.getLogicalSpace=function(t,e,o){e=this._lSpace;var r,a,i=this.conf,n=i.padding;a=i.legendAxisHeight;var l,s=this.compositionsByCategory;return l=0,e&&!o?(e.isImpure=!0,e):(e=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0}},(o=y(t,{})).height-=2*n.v,o.width-=2*n.h,o.x+=n.h,o.y+=n.v,i=a/2+i.line.offset,r=a/2,(s=s.RANGE)&&(l=(l=s.sliders[!1]).conf.outerCircle.rFactor*a,r+=l=Math.max(l/2-a/2,0)),o.y+=l,o.height=a=r+i+l,t.height=a+2*n.v,e.node.logicArea=o,e.bound=t)},w.prototype.getDrawableAxisArea=function(t){var e=this.conf;return{x:t.x,y:t.y,width:t.width,height:e.legendAxisHeight,r:e.legendAxisHeight/2}},w.prototype.preDrawingRangeParam=function(t){return{y:t.y+t.height/2,calculationBase:t.height,rangeStart:t.x,rangeEnd:t.x+t.width,prop:"y"}},w.prototype.getScaleMarkerPathStr=function(t,e){var o,r,a,i,n=y(t,{}),l=this.conf.line,s="";for(n.x+=n.r,n.width-=2*n.r,i=n.y+n.height,o=0,r=e.length;o<r;o++)a=e[o],s+="M"+(a=n.x+a*n.width/100)+","+(i-l.grooveLength)+"L"+a+","+(i+l.offset);return s+(n="M"+n.x+","+(i+l.offset)+"L"+(n.x+n.width)+","+(i+l.offset))},w.prototype.getColorGradient=function(t){return{axis:t.getBoxFill(),shadow:n({FCcolor:{alpha:"25,0,0",angle:90,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},w.prototype.draw=function(){var t,e,o,r,a,i,n,l,s,h=this.conf,c=h.line,d=(h.bound||{}).style||{},p=this.compositionsByCategory;for(o in 2<=arguments.length?(e=arguments[0],l=arguments[1]):1<=arguments.length&&(l=arguments[0]),t=l.parentLayer,a=(r=l.colorRange).getCumulativeValueRatio(),i=(s=l.componentPool).getKeys(),this.getLogicalSpace(e,l),n=this._lSpace,t=(e=s.getComponent(this._id,i.KEY_GROUP))("legend-axis",t),e=s.getComponent(this._id,i.KEY_RECT,!0),this.bound=e(t).attr(n.bound).css(d),d=this.getDrawableAxisArea(n.node.logicArea),r=this.getColorGradient(r),h.style.fill=r.axis,h.shadow.style.fill=r.shadow,this.node=e(t).attr(d).css(h.style),this.shadow=e(t).attr(d).css(h.shadow.style),h=this.getScaleMarkerPathStr(d,a),(e=s.getComponent(this._id,i.KEY_PATH))("M0,0",t).attr({path:h}).css(c.style),p)switch(c=p[o],o){case"RANGE":l[(i=this.preDrawingRangeParam(d)).prop]=i[i.prop],l.key=i.prop,l.rCalcBase=i.calculationBase,l.parentLayer=t,c.draw(i.rangeStart,i.rangeEnd,l)}},((x.prototype=Object.create(w.prototype)).constructor=x).prototype.getLogicalSpace=function(t,e,o){e=this._lSpace;var r,a,i=this.conf,n=i.padding;a=i.legendAxisHeight;var l,s=this.compositionsByCategory;return l=0,e&&!o?(e.isImpure=!0,e):(e=this._lSpace={bound:{height:0,width:0},node:{logicArea:void 0}},(o=y(t,{})).height-=2*n.v,o.width-=2*n.h,o.x+=n.h,o.y+=n.v,i=a/2+i.line.offset,r=a/2,(s=s.RANGE)&&(l=(l=s.sliders[!1]).conf.outerCircle.rFactor*a,r+=l=Math.max(l/2-a/2,0)),o.x+=l,o.width=a=r+i+l,t.width=a+2*n.v,e.node.logicArea=o,e.bound=t)},x.prototype.getDrawableAxisArea=function(t){var e=this.conf;return{x:t.x,y:t.y,width:e.legendAxisHeight,height:t.height,r:e.legendAxisHeight/2}},x.prototype.getScaleMarkerPathStr=function(t,e){var o,r,a,i,n=y(t,{}),l=this.conf.line,s="";for(n.y+=n.r,n.height-=2*n.r,i=n.x+n.width,o=0,a=e.length;o<a;o++)r=e[o],r=n.y+r*n.height/100,s+="M"+(i-l.grooveLength)+","+r+"L"+(i+l.offset)+","+r;return s+(n="M"+(i+l.offset)+","+n.y+"L"+(i+l.offset)+","+(n.y+n.height))},x.prototype.getColorGradient=function(t){return{axis:t.getBoxFill(!0),shadow:n({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},x.prototype.preDrawingRangeParam=function(t){return{x:t.x+t.width/2,calculationBase:t.width,rangeStart:t.y,rangeEnd:t.y+t.height,prop:"x"}},(C.prototype.constructor=C).prototype.initRange=function(t,e){this.extremes[+t.sliderIndex]=e},C.prototype.updateRange=function(t,e){var o=t.sliderIndex;this.sliders[!o].updateSwingRange(o,e)},C.prototype.reset=function(){var t={};t.conf=this.conf,(t.sliderGroup=this).sliders[!1]=new o(!1,t,this._id+"_0"),this.sliders[!0]=new o(!0,t,this._id+"_1"),this.draw.apply(this,this._drawParams)},C.prototype.clearListeners=function(){this.callbacks.length=0},C.prototype.draw=function(t,e,o){var r=(a=this.sliders)[!1],a=a[!0],i=o.colorRange,n=i.colorRange,l=this._fcChart=o.componentPool.getChart();return this.getValueFormPixel=function(e,t,o,r){var a=(t-e)/(r-o);this.getValueFormPixel=function(t){return e+a*t}},this.updateWhenInMove=function(r,a){this.updateWhenInMove=function(t,e){var o=this.extremes;o=this.getValueFormPixel(t.sliderIndex?o[1]-o[0]+e:e);return a?parseFloat(o).toFixed(2)+"%":r.legendValue(o)}},this._drawParams=[t,e,o],this.updateWhenInMove(l.components.numberFormatter,i.mapByPercent),t=r.draw(t,n[0].displayValue,o[o.key],o),t=a.draw(e,n[n.length-1].displayValue,o[o.key],o),r.swing=this.extremes.slice(0),a.swing=this.extremes.slice(0),this.getValueFormPixel(n[0].value,n[n.length-1].value,this.extremes[0],this.extremes[1]),t},C.prototype.registerListener=function(t,e,o){this.callbacks.push({fn:t,context:e,params:o||[]})},C.prototype.updateWhenInRest=function(t,e){var o,r,a,i=this.sliders,n=this.extremes,l=t.sliderIndex,s=this.callbacks;for(l?(o=i[!l].currPos,i=n[1]-n[0]+e):(o=e,i=n[1]-n[0]+i[!l].currPos),n=0,l=s.length;n<l;n++)(a=(r=s[n]).params.slice(0)).unshift(this.getValueFormPixel(i)),a.unshift(this.getValueFormPixel(o)),r.fn.apply(r.context,a)},C.prototype.dragStarted=function(t){var e=this.sliders,o=this.extremes,r=t.conf,a=this._fcChart;E.raiseEvent("legendpointerdragstart",{pointerIndex:+t.sliderIndex,pointers:[{value:this.getValueFormPixel(e[!1].currPos)},{value:this.getValueFormPixel(o[1]-o[0]+e[!0].currPos)}],legendPointerHeight:r.outerRadius,legendPointerWidth:r.innerRadius,outerRadius:r.outerRadius,innerRadius:r.innerRadius},a.chartInstance,[a.id])},C.prototype.dragCompleted=function(t,e,o){var r,a=this.sliders,i=this.extremes,n=t.conf,l=this.getValueFormPixel(a[!1].currPos),s=(a=this.getValueFormPixel(i[1]-i[0]+a[!0].currPos),this._fcChart);t.sliderIndex?(r=l,o=this.getValueFormPixel(i[1]-i[0]+o)):(r=this.getValueFormPixel(o),o=a),e&&E.raiseEvent("legendrangeupdated",{previousMinValue:l,previousMaxValue:a,minValue:r,maxValue:o},s.chartInstance,[s.id]),E.raiseEvent("legendpointerdragstop",{pointerIndex:+t.sliderIndex,pointers:[{value:l},{value:a}],legendPointerHeight:n.outerRadius,legendPointerWidth:n.innerRadius,outerRadius:n.outerRadius,innerRadius:n.innerRadius},s.chartInstance,[s.id])},(o.prototype.constructor=o).prototype.updateSwingRange=function(t,e){this.swing[+t]=e},o.prototype.draw=function(t,e,o,r){var a,i,n=r.parentLayer,l=this.conf,s=l.outerCircle,h=l.innerCircle,c=Math.ceil(s.rFactor*r.rCalcBase/2),d=Math.ceil(h.rFactor*r.rCalcBase/2),p=c-d,g=this.rangeGroup,u=this.sliderIndex,f=r.componentPool,m=f.getKeys();return l.outerRadius=c,l.innerRadius=d,this._scaleVal=e,h.style["stroke-width"]=p,d+=p=Math.ceil(s.style["stroke-width"]/2),i=f.getComponent(this._id,m.KEY_GROUP),n=this.node=i("fc-gl-slider",n).attr({cursor:"pointer",transform:"t0,0"}),"x"===r.key?t=a=t+(u?-d:+d):(a=o,t=o=t+(u?-d:+d)),g.initRange(this,t),(i=f.getComponent(this._id,m.KEY_CIRCLE,!0))(n).attr({cx:o,cy:a,r:c}).css(s.style),i(n).attr({cx:o,cy:a,r:d}).css(h.style),e=this.tracker=i(n).attr({cx:o,cy:a,r:c+5,ishot:!0,fill:G,stroke:0,cursor:"pointer"}).trackTooltip(!!l.showTooltip).tooltip(e,null,null,!0),this._dragAPI=r=this.getDragAPI("x"===r.key),e.undrag(),e.drag(r.dragging,r.dragStart,r.dragEnd),{translateAscending:c+p}},o.prototype.getDragAPI=function(n){var l,s,h,c,d=this,p=d.node,g=d.sliderIndex,u=d.rangeGroup,f=d.conf.innerRadius;return{dragging:function(t,e){var o,r,a,i;return t.stopPropagation(),t.preventDefault(),a=n?e[1]:e[0],g?(o=l[0]-l[1]+f,r=0):(o=0,r=l[1]-l[0]-f),(i=d.currPos+a)<o?a+=o-i:r<i&&(a-=i-r),p.attr({transform:n?"t0,"+(d.currPos+a):"t"+(d.currPos+a)+",0"}),s=a,h&&clearTimeout(h),h=setTimeout(function(){u.updateWhenInRest(d,d.currPos+a)},100),d.tracker.tooltip(u.updateWhenInMove(d,d.currPos+a),null,null,!0),c=!0},dragStart:function(t){t.stopPropagation(),t.preventDefault(),p.attr({transform:n?"t0,"+d.currPos:"t"+d.currPos+",0"}),l=l||d.swing,c=!1,u.dragStarted(d)},dragEnd:function(){var t;u.dragCompleted(d,c,d.currPos+s),c&&(h&&clearTimeout(h),h=setTimeout(function(){u.updateWhenInRest(d,d.currPos)},100),d.currPos+=s,t=l[+g]+d.currPos,u.updateRange(d,t))}}},(S.prototype.constructor=S).prototype.getValueRatio=function(){var t,e,o=this.colorRange,r=o.length,a=this.valueRatio,i=o[0].value,n=o[r-1].value-i,l=0;if(a)return a;for(a=this.valueRatio=[],e=0;e<r;e++)t=((t=o[e]).value-i)/n,a.push(100*(t-l)),l=t;return a},S.prototype.getCumulativeValueRatio=function(){var t,e,o=this.colorRange,r=o.length,a=o[0].value,i=o[r-1].value,n=[];for(e=0;e<r;e++)t=o[e],n.push((t.value-a)/(i-a)*100);return n},S.prototype.getBoxFill=function(t){var e,o,r=this.colorRange,a=r.length,i=[];for(o=t?90:0,e=0;e<a;e++)t=r[e],i.push(t.code);return r={FCcolor:{alpha:"100,100,100",angle:o,color:i.join(","),ratio:this.getValueRatio().join(",")}},n(r)},S.prototype.getColorByValue=function(t){var e,o,r,a,i=this.values,n=this.colorRange;if(null!=t){for(o=0,e=i.length;o<e;o++){if(t===i[o]){a=n[o].code;break}if(!o&&t<i[o]){r=!0;break}if(o===e-1&&t>i[o]){r=!0;break}if(t>i[o]&&t<i[o+1]){i=n[o],e=n[o+1],n=i.value,o=M(i.code),i=e.value,e=M(e.code),a=a=void 0,a=i-n,a=[Math.round(o[0]+(e[0]-o[0])/a*(t-n)),Math.round(o[1]+(e[1]-o[1])/a*(t-n)),Math.round(o[2]+(e[2]-o[2])/a*(t-n))],a=l(a);break}}if(!r)return a}},(_.prototype=Object.create(t.prototype)).constructor=_,K.register("component",["gradientLegend","gradientLegend",{pIndex:1,enabled:!1,init:function(e){function t(t){n.data=e.chart.jsonData.colorrange,(a=n.nData=L.legacyDataParser(n.data,t))?(n.drawOptions={smartLabel:l.linkedItems.smartLabel,colorRange:n.colorRange=r=new S(a,t,i),maxOtherSide:t.maxOtherSide},n._dontPlot=!1,r&&r._preparationGoneWrong&&(n._dontPlot=!0),n._recalculateLogicalSpace=!0,n._configure()):n._dontPlot=!0}var o,r,a,i,n=this,l=e.chart;if(L.init(e),i=n._chart=e.chart,n._cpool=A(i),!(o=e.dataExtremes))return t;t(o)},_configure:function(){var t,e,o,r,a,i,n,l=(p=this._chart).jsonData.chart,s=this.conf={},h=l.outcnvbasefont,c=l.outcnvbasefontsize,d=l.outcnvbasefontcolor,p=p.config.dataLabelStyle;s.caption=T(l.legendcaption),s.legendPosition=T(l.legendposition,"bottom").toLowerCase(),s.showLegend=I(l.showlegend,1),s.interactiveLegend=I(l.interactivelegend,1),s.showLegendLabels=I(l.showlegendlabels,1),t=l.legenditemfontcolor||d,e=l.legenditemfont||h,o=l.legenditemfontsize||c,r=I(l.legenditemfontbold,0),d=l.legendcaptionfontcolor||d,h=l.legendcaptionfont||h,c=l.legendcaptionfontsize||c,a=I(l.legendcaptionfontbold,1),n=(i=l.legendaxisbordercolor?P(R(l.legendaxisbordercolor)):void 0)?I(l.legendaxisborderalpha,100)/100:void 0,s.axisTextItemConf={style:{fill:t?O(T(t)):p.color,fontFamily:e?T(e):p.fontFamily,fontSize:o?I(o):p.fontSize.match(/\d+/)[0],fontWeight:r?"bold":p.fontWeight}},s.legendCaptionConf={style:{fill:d?O(T(d)):p.color,fontFamily:h?T(h):p.fontFamily,fontSize:c?I(c):p.fontSize.match(/\d+/)[0],fontWeight:a?"bold":p.fontWeight,fontStyle:"normal"}},s.legendAxisConf={legendAxisHeight:11,style:{stroke:i,"stroke-opacity":n},line:{style:{stroke:O(T(l.legendscalelinecolor,"FFF8E9"),I(l.legendscalelinealpha,100)),"stroke-width":I(l.legendscalelinethickness)}}},s.sliderGroupConf={showTooltip:I(l.showtooltip,1),outerCircle:{rFactor:I(l.sliderdiameterfactor),style:{stroke:O(T(l.legendpointerbordercolor,"757575"),I(l.legendpointerborderalpha,100))}},innerCircle:{rFactor:I(l.sliderholediameterfactor),style:{stroke:O(T(l.legendpointercolor,"FFFFFF"),I(l.legendpointeralpha,100))}}},s.legendCarpetConf={spreadFactor:I(l.legendspreadfactor),allowDrag:!!I(l.legendallowdrag,0),captionAlignment:T(l.legendcaptionalignment,"center"),style:{fill:O(T(l.legendbgcolor,"e4d9c1"),I(l.legendbgalpha,100)),stroke:O(T(l.legendbordercolor,"c4b89d"),I(l.legendborderalpha,100)),"stroke-width":I(l.legendborderthickness,1)}}},postConfigureInit:function(){var t,e,o,r,a,i,n,l=this.conf;this.elem={},l.caption&&(e=y(L.getDefaultConf("legendCaptionConf"),l.legendCaptionConf),t=new c(l.caption,e)),l.interactiveLegend&&(e=y(L.getDefaultConf("sliderGroupConf"),l.sliderGroupConf),this.elem.sGroup=r=new C(e),this.listeners&&0<this.listeners.length&&r.registerListener.apply(r,this.listeners)),e=y(L.getDefaultConf("legendCarpetConf"),l.legendCarpetConf),"bottom"===l.legendPosition?(this.drawOptions.refSideKey="canvasWidth",this.drawOptions.refOffsetKey="canvasLeft",e=new s(e),a=y(L.getDefaultConf("axisTextItemConf"),l.axisTextItemConf),i=new p(this.drawOptions.colorRange,L.getDefaultConf("legendBodyConf"),a),o=new w(y(L.getDefaultConf("legendAxisConf"),l.legendAxisConf)),l.showLegendLabels&&(n=new f(a)),l=new v(a)):(this.drawOptions.refSideKey="canvasHeight",this.drawOptions.refOffsetKey="canvasTop",a=y(L.getDefaultConf("axisTextItemConf"),l.axisTextItemConf),e=new h(e),i=new u(this.drawOptions.colorRange,L.getDefaultConf("legendBodyConf"),a),o=new x(y(L.getDefaultConf("legendAxisConf"),l.legendAxisConf)),l.showLegendLabels&&(n=new m(a)),l=new b(a)),r&&o.addCompositions(r,"RANGE"),n&&i.addCompositions(n,"LEGEND_LABEL"),i.addCompositions(o,"LEGEND_AXIS"),i.addCompositions(l,"AXIS_VALUE"),t&&e.addCompositions(t,"CAPTION"),e.addCompositions(i,"LEGEND_BODY"),this.elem.gl=new _(e,this._cpool)},notifyWhenUpdate:function(t,e,o){var r;(r=this.elem&&this.elem.sGroup)?r.registerListener(t,e,o):this.listeners=[t,e,o]},dispose:function(){this.elem&&this.elem.gl&&this.elem.gl.dispose(),this.elem={}},getLogicalSpace:function(t){var e=this.conf,o={height:0,width:0},r=this.drawOptions,a=this._chart;return this._recalculateLogicalSpace?this._dontPlot?o:(this._recalculateLogicalSpace=!1,this.postConfigureInit(),e.showLegend?(e=r.refSideKey,r=r.refOffsetKey,this.drawOptions.refSide=a.config[e],this.drawOptions.refOffset=a.config[r],this.drawOptions.maxOtherSide=t||this.drawOptions.maxOtherSide,this.elem.gl&&(this._logicalArea=this.elem.gl.getLogicalSpace(this.drawOptions,!0))):o):(e=r.refSideKey,r=r.refOffsetKey,this.drawOptions.refSide=a.config[e],this.drawOptions.refOffset=a.config[r],(this._logicalArea=this.elem.gl.getLogicalSpace(this.drawOptions,!0))||o)},resetLegend:function(){var t;(t=this.elem&&this.elem.sGroup)&&t.reset()},clearListeners:function(){var t;(t=this.elem&&this.elem.sGroup)&&t.clearListeners()},draw:function(t,e,o){var r=this.conf;this._dontPlot||(this._cpool.init(o.paper),r.showLegend?(this.drawOptions.paper=o.paper,this.drawOptions.parentGroup=o.parentGroup,this.drawOptions.x=t,this.drawOptions.y=e,this.drawOptions.maxOtherSide=this.drawOptions.maxOtherSide||o.maxOtherSide,t=(t=this.elem.gl.draw(this.drawOptions)).getBBox(),r.xPos=t.x,r.yPos=t.y,r.height=t.height,r.width=t.width,this.enabled=!0):this.enabled=!1)}}])}]),K.register("module",["private","modules.renderer.js-maps",function(){var C=this,t=C.window,m=C.hcLib,n=m.chartAPI,o=m.addEvent,r=m.removeEvent,L=m.pluck,d=m.imprint,A=m.extend2,F=m.parseTooltext,E=m.pluckNumber,h=m.graphics.getLightColor,c=m.dropHash,p=m.HASHSTRING,I=m.parseUnsafeString,a=m.getDashStyle,f=m.schedular,i=A(m.defaultPaletteOptions,{foregroundcolor:"333333",foregroundalpha:"100",foregrounddarkcolor:"111111",foregrounddarkalpha:"100",foregroundlightcolor:"666666",foregroundlightalpha:"100",backgroundlightcolor:"FFFFFF",backgroundlightalpha:"100",backgroundlightangle:90,backgroundlightratio:"",backgroundcolor:"FFFFCC",backgroundalpha:"100",backgrounddarkcolor:"ffcc66",backgrounddarkalpha:"100",backgrounddarkangle:270,backgrounddarkratio:"",shadow:1}),l=m.setLineHeight,T=m.graphics.convertColor,e=t.navigator.userAgent,x=/msie/i.test(e)&&!t.opera,S=m.hasSVG,v=t.Math,y=v.min,k=v.max,_=/stroke/gi,R=/AppleWebKit/.test(e),P=v.ceil,u=Math.PI/180,s=m.hasTouch,O=(t=!m.CREDIT_REGEX.test(t.location.hostname),m.toRaphaelColor),b="rgba(192,192,192,"+(x?.002:1e-6)+")",g=function(t,e){var o;for(o in t||(t={}),e)t[o]=e[o];return t},M=function(t,e){var o=e?g(t.FCcolor,e):{FCcolor:t};return o.toString=O,o},w=function(t,e){var o,r;for(r in this.index=e,t)o=i[t[r]],this[r]=o instanceof Array?o[e]:o},B={right:function(t,e){return e},left:function(t,e){return t-e},center:function(t,e){return 2*y(e,t-e)}},D={top:function(t,e){return e},middle:function(t,e){return 2*y(e,t-e)},bottom:function(t,e){return t-e}},G=function(t,e){var o,r=t&&t.length||!1,a=e||"id",i={};if(!t)return t;for(;r--;)void 0!==(o=t[r])[a]&&(i[o[a].toLowerCase()]=o);return i},V=m.KdTree;g(m.eventList,{entityrollover:"FC_Event",entityrollout:"FC_Event"}),n("geo",{name:"geo",friendlyName:"Map",revision:1,creditLabel:t,hasCanvas:!0,standaloneInit:!1,defaultDatasetType:"maps",baseWidth:400,baseHeight:300,baseScaleFactor:1,defaultSeriesType:"geo",fireGroupEvent:!0,legendposition:"right",hasGradientLegend:!0,isMap:!0,entities:{},init:function(t,e,o,r){var a,i;i=e.chart=e.chart||e.graph||e.map||{},this.jsonData=e,(a=this.components=this.components||(this.components={})).mapAnnotations=a.mapAnnotations||(a.mapAnnotations=new m.Annotations),this.components.colorPalette=new w(this.colorPaletteMap,(0<i.palette&&i.palette<6?i.palette:E(this.paletteIndex,1))-1),i=K.register("component",["caption","MapCaption"]),a.caption||(a.caption=new i),n.mscartesian.init.call(this,t,e,o,r)},configure:function(){var t,e,o,r,a,i=(t=this.jsonData).chart||t.map,n=t.markers,l=new w(this.colorPaletteMap,(0<i.palette&&i.palette<6?i.palette:E(this.paletteIndex,1))-1),s=L(i.entitybordercolor,i.bordercolor,l.plotbordercolor),h=L(i.entityfillcolor,i.fillcolor,l.plotfillcolor),c=L(i.entityfillalpha,i.fillalpha,l.plotfillalpha),d=L(i.entityfillratio,i.fillratio,l.plotfillratio),p=L(i.entityfillangle,i.fillangle,l.plotfillangle),g=L(i.nullentityfillcolor,i.nullentitycolor,h),u=E(i.usevaluesformarkers,t.markers&&t.markers.items&&t.markers.items.length,!(t.markers&&t.markers.application&&t.markers.application.length&&t.markers.definition&&t.markers.definition.length));this.base.base.configure.call(this),(t=this.config).origMarginTop=E(i.charttopmargin,i.maptopmargin,11),t.origMarginLeft=E(i.chartleftmargin,i.mapleftmargin,11),t.origMarginBottom=E(i.chartbottommargin,i.mapbottommargin,11),t.origMarginRight=E(i.chartrightmargin,i.maprightmargin,11),e=(a=t.style).inCancolor,o=a.inCanfontFamily,r=a.inCanfontSize,t.entityOpts={baseScaleFactor:this.baseScaleFactor,dataLabels:{style:{fontFamily:o,fontSize:r,lineHeight:a.inCanLineHeight,color:a.inCancolor}},fillColor:h,fillAlpha:c,fillRatio:d,fillAngle:p,borderColor:s,borderAlpha:L(i.entityborderalpha,i.borderalpha,this.borderAlpha,"100"),borderThickness:E(i.showentityborder,i.showborder,1)?E(i.entityborderthickness,i.borderthickness,1):0,scaleBorder:E(i.scaleentityborder,i.scaleborder,0),hoverFillColor:L(i.entityfillhovercolor,i.hoverfillcolor,i.hovercolor,l.plothoverfillcolor),hoverFillAlpha:L(i.entityfillhoveralpha,i.hoverfillalpha,i.hoveralpha,l.plothoverfillalpha),hoverFillRatio:L(i.entityfillhoverratio,i.hoverfillratio,i.hoverratio,l.plothoverfillratio),hoverFillAngle:L(i.entityfillhoverangle,i.hoverfillangle,i.hoverangle,l.plothoverfillangle),hoverBorderThickness:L(i.entityborderhoverthickness,i.hoverborderthickness),hoverBorderColor:L(i.entityborderhovercolor,l.plotbordercolor),hoverBorderAlpha:L(i.entityborderhoveralpha,l.plotborderalpha),nullEntityColor:g,nullEntityAlpha:L(i.nullentityfillalpha,i.nullentityalpha,c),nullEntityRatio:L(i.nullentityfillratio,i.nullentityratio,d),nullEntityAngle:L(i.nullentityfillangle,i.nullentityangle,p),connectorColor:L(i.labelconnectorcolor,i.connectorcolor,e),connectorAlpha:L(i.labelconnectoralpha,i.connectoralpha,"100"),connectorThickness:E(i.labelconnectorthickness,i.borderthickness,1),showHoverEffect:E(i.showentityhovereffect,i.usehovercolor,i.showhovereffect,1),hoverOnNull:E(i.hoveronnull,i.entityhoveronnull,1),labelPadding:E(i.labelpadding,5),showLabels:E(i.showlabels,1),labelsOnTop:E(i.entitylabelsontop,1),includeNameInLabels:E(i.includenameinlabels,1),includeValueInLabels:E(i.includevalueinlabels,0),useSNameInTooltip:E(i.usesnameintooltip,0),useShortName:E(i.usesnameinlabels,1),labelSepChar:L(i.labelsepchar,", "),showTooltip:E(i.showentitytooltip,i.showtooltip,1),tooltipSepChar:L(i.tooltipsepchar,", "),tooltext:i.entitytooltext,hideNullEntities:E(i.hidenullentities,0),showHiddenEntityBorder:E(i.showhiddenentityborder,1),showNullEntityBorder:E(i.shownullentityborder,1),hiddenEntityColor:L(i.hiddenentitycolor,i.hiddenentityfillcolor,i.hiddenentityalpha||i.hiddenentityfillalpha?g:"ffffff"),hiddenEntityAlpha:L(i.hiddenentityalpha,i.hiddenentityfillalpha,.001),shadow:E(i.showshadow,this.defaultPlotShadow,l.shadow)},t.markerOpts={dataLabels:{style:{fontFamily:L(i.markerfont,o),fontSize:E(i.markerfontsize,parseInt(r,10)),fontColor:L(i.markerfontcolor,e)}},showTooltip:E(i.showmarkertooltip,i.showtooltip,1),showLabels:E(i.showmarkerlabels,i.showlabels,1),showHoverEffect:E(i.showmarkerhovereffect,1),labelPadding:L(i.markerlabelpadding,"5"),labelWrapWidth:E(i.markerlabelwrapwidth,0),labelWrapHeight:E(i.markerlabelwrapheight,0),fillColor:L(i.markerfillcolor,i.markerbgcolor,l.markerfillcolor),fillAlpha:L(i.markerfillalpha,l.markerfillalpha),fillAngle:L(i.markerfillangle,l.markerfillangle),fillRatio:L(i.markerfillratio,l.markerfillratio),fillPattern:L(i.markerfillpattern,l.markerbgpattern),hoverFillColor:i.markerfillhovercolor,hoverFillAlpha:i.markerfillhoveralpha,hoverFillRatio:i.markerfillhoverratio,hoverFillAngle:i.markerfillhoverangle,borderThickness:L(i.markerborderthickness,1),borderColor:L(i.markerbordercolor,l.markerbordercolor),borderAlpha:E(i.markerborderalpha,l.markerborderalpha),hoverBorderThickness:i.markerborderhoverthickness,hoverBorderColor:i.markerborderhovercolor,hoverBorderAlpha:i.markerborderhoveralpha,radius:E(i.markerradius&&m.trimString(i.markerradius),7),shapeId:L(i.defaultmarkershape,"circle"),labelSepChar:L(i.labelsepchar,", "),tooltipSepChar:L(i.tooltipsepchar,", "),autoScale:E(i.autoscalemarkers,0),tooltext:L(n&&n.tooltext,i.markertooltext),dataEnabled:u,valueToRadius:E(i.markerradiusfromvalue,1),valueMarkerAlpha:L(i.valuemarkeralpha,"75"),hideNull:E(i.hidenullmarkers,0),nullRadius:E(i.nullmarkerradius,i.markerradius,7),adjustViewPort:E(i.adjustviewportformarkers,0),startAngle:E(i.markerstartangle,90),maxRadius:E(i.maxmarkerradius,0),minRadius:E(i.minmarkerradius,0),applyAll:E(i.applyallmarkers,0),shadow:E(i.showmarkershadow,i.showshadow,0)},t.connectorOpts={showHoverEffect:E(i.showconnectorhovereffect,1),thickness:E(i.connectorthickness,i.markerconnthickness,"2"),color:L(i.connectorcolor,i.markerconncolor,l.markerbordercolor),alpha:L(i.connectoralpha,i.markerconnalpha,"100"),hoverThickness:E(i.connectorhoverthickness,i.connectorthickness,i.markerconnthickness,"2"),hoverColor:L(i.connectorhovercolor,i.connectorcolor,i.markerconncolor,l.markerbordercolor),hoverAlpha:L(i.connectorhoveralpha,i.connectoralpha,i.markerconnalpha,"100"),dashed:E(i.connectordashed,i.markerconndashed,0),dashLen:E(i.connectordashlen,i.markerconndashlen,3),dashGap:E(i.connectordashgap,i.markerconndashgap,2),font:L(i.connectorfont,i.markerconnfont,o),fontColor:L(i.connectorfontcolor,i.markerconnfontcolor,e),fontSize:E(i.connectorfontsize,i.markerconnfontsize,parseInt(r,10)),showLabels:E(i.showconnectorlabels,i.showmarkerlabels,i.showlabels,1),labelBgColor:L(i.connectorlabelbgcolor,i.markerconnlabelbgcolor,l.plotfillcolor),labelBorderColor:L(i.connectorlabelbordercolor,i.markerconnlabelbordercolor,l.markerbordercolor),shadow:E(i.showconnectorshadow,i.showmarkershadow,i.showshadow,0),showTooltip:E(i.showconnectortooltip,i.showmarkertooltip,i.showtooltip,1),tooltext:L(n&&n.connectortooltext,i.connectortooltext),hideOpen:E(i.hideopenconnectors,1)},t.adjustViewPortForMarkers=E(i.adjustviewportformarkers,u)},_createLayers:function(){var t=this.graphics||(this.graphics={}),e=this.components.paper;(t=this.graphics).backgroundGroup=t.backgroundGroup||e.group("background"),t.canvasGroup=t.canvasGroup||e.group("canvas"),t.shadowGroup=t.shadowGroup||e.group("shadow"),t.datasetGroup=t.datasetGroup||e.group("dataset"),t.datalabelsGroup=t.datalabelsGroup||e.group("datalabel"),t.legendGroup=t.legendGroup||e.group("legend"),t.captionGroup=t.captionGroup||e.group("caption"),t.captionGroup.trackTooltip(!0),t.datasetGroup.trackTooltip(!0),t.buttonGroup=t.buttonGroup||e.group("buttons"),this._attachMouseEvents()},_attachMouseEvents:function(){var t=(t=this.linkedItems).eventListeners||(t.eventListeners=[]),e=this.linkedItems.container;r(e,s?"touchstart":"mousemove",this.searchMouseMove),t.push(o(e,"touchstart mousemove",this.searchMouseMove,this))},searchMouseMove:function(t){var e=t.data,o=e.config,r={};if(e.linkedItems.container){var a=(r=m.getMouseCoordinate(e.linkedItems.container,t)).chartX,i=r.chartY,n=(h=e.config).canvasLeft,l=h.canvasTop,s=h.canvasLeft+h.canvasWidth,h=h.canvasHeight+h.canvasTop;r.insideCanvas=!1,r.originalEvent=t,n<a&&a<s&&l<i&&i<h&&(r.insideCanvas=!0),r&&r.insideCanvas&&(o.lastMouseEvent=t,r={x:r.chartX,y:r.chartY},e._searchNearestNeighbour(r))}},_searchNearestNeighbour:function(t){var e=this.components.dataset[1];e&&e.components.kDTree&&((t=e.getElement(t))?this.config.lastHoveredPoint!==t&&e.highlightPoint(t):e.highlightPoint(!1))},_createDatasets:function(){var t=this.components,e=this.jsonData,o=this.defaultDatasetType,r=e.data||{},a=e.markers,i=(e=0,this.components.dataset);i=t.dataset||(t.dataset=[]);o&&o.toLowerCase(),(o=K.get("component",["dataset","Entities"]))&&(i[e]?(i[e].JSONData=r,i[e].configure()):(t=new o,i.push(t),t.chart=this,t.index=void 0,t.init(r)),e++),o=K.get("component",["dataset","Markers"]),t=i[e],o&&a?i[e]?(t.index=void 0,t.init(a),i[e].configure()):(t=new o,i.push(t),t.chart=this,t.index=void 0,t.init(a)):"markers"===(r=t&&t.type)&&i.splice(e,1)},_parseBackgroundCosmetics:function(){var t,e=this.components.background.config,o=this.components.colorPalette,r=this.jsonData.chart;t=e.showBorder=E(r.showcanvasborder,1),e.borderWidth=t=t?E(r.canvasborderthickness,1):0,e.borderRadius=e.borderRadius=E(r.canvasborderradius,0),e.borderDashStyle=e.borderDashStyle=E(r.borderdashed,0)?a(E(r.borderdashlen,4),E(r.borderdashgap,2),t):"none",e.borderColor=e.borderColor=T(L(r.canvasbordercolor,o&&o.borderColor)),e.borderAlpha=L(r.canvasborderalpha,o.borderAlpha)},_getBackgroundCosmetics:function(){var t=this.jsonData.chart||this.jsonData.map,e=this.components.colorPalette;return{FCcolor:{color:L(t.bgcolor,t.canvasbgcolor,e.bgcolor),alpha:L(t.bgalpha,t.canvasbgalpha,e.bgalpha),angle:L(t.bgangle,t.canvasbgangle,e.bgangle),ratio:L(t.bgratio,t.canvasbgratio,e.bgratio)}}},_parseCanvasCosmetics:function(){var t=this.config,e=this.jsonData.chart||this.jsonData.map,o=this.components.canvas.config;t.origMarginTop=E(e.maptopmargin,11),t.origMarginLeft=E(e.mapleftmargin,11),t.origMarginBottom=E(e.mapbottommargin,11),t.origMarginRight=E(e.maprightmargin,11),t.origCanvasLeftMargin=E(e.canvasleftmargin,0),t.origCanvasRightMargin=E(e.canvasrightmargin,0),t.origCanvasTopMargin=E(e.canvastopmargin,0),t.origCanvasBottomMargin=E(e.canvasbottommargin,0),o.canvasBorderRadius=E(e.canvasborderradius,0),o.origCanvasTopPad=E(e.canvastoppadding,0),o.origCanvasBottomPad=E(e.canvasbottompadding,0),o.origCanvasLeftPad=E(e.canvasleftpadding,0),o.origCanvasRightPad=E(e.canvasrightpadding,0)},draw:function(){this.config.entitiesDrawn=!1,this.config.hasChartMessage?(this._hide(),this.drawChartMessage()):(this._show(),this.chartMenuTools.reset(this.components.tb,this),this._createToolBox(),this._manageSpace(),this._updateVisuals(),this.inited=!0,this.chartInstance.jsVars.drawCount+=1,this.chartInstance.__state.dataReady=!0,this.chartInstance.jsVars.hasNativeMessage=!1)},_drawDataset:function(){var t=this.chartInstance,e=this.components.dataset,o=this.graphics,r=e.length,a=this.config.scalingParams;for(o.datasetGroup.hide(),o.shadowGroup.hide(),this.config.entitiesReady=!1,t.addEventListener("internal.mapdrawingcomplete",function(t){t.detachHandler(),S&&(o.datasetGroup&&o.datasetGroup.attr({transform:a.transformStr}),o.shadowGroup&&o.shadowGroup.attr({transform:a.transformStr})),o.datasetGroup&&o.datasetGroup.show(),o.shadowGroup&&o.shadowGroup.show()}),t=0;t<r;t++)e[t].draw();this.checkComplete()},preliminaryScaling:function(){for(var t,e,o=this.jsonData,r=(o=o.markers&&o.markers.items||[]).length||0,a=1/0,i=1/0,n=-1/0,l=-1/0;r--;)e=o[r],t=Number(e.x),e=Number(e.y),a=y(a,t),i=y(i,e),n=k(n,t),l=k(l,e);return{x:a,y:i,x1:n,y1:l}},getScalingParameters:function(t,e,o,r){var a=t/e,i=o/(t*this.baseScaleFactor),n=r/(e*this.baseScaleFactor),l=0,s=0;return n<i?(l+=(o-r*a)/2,t=200/(e*(i=n))):(s+=(r-o/a)/2,t=200/(t*i)),{scaleFactor:i,strokeWidth:t,translateX:l,translateY:s}},calculateMarkerBounds:function(t,e,o){var r,a,i,n,l,s=this.config,h=s.markerOpts,c=this.components.dataset,d=(p=this.getDataLimits()).dataMin,p=p.dataMax,g=h.hideNull,u=h.nullRadius,f=(h=h.valueToRadius,1/0),m=1/0,v=-1/0,b=-1/0;for(i=0,n=c.length;i<n;i++)"markers"===(a=(s=c[i]).type)&&(r=s);if(r)for(i in r.calculateMarkerRadiusLimits(),c=(a=r.conf||{}).minRadius,a=a.maxRadius,r=r.components&&r.components.markerObjs||{})l=(s=(s=r[i]).config).definition||{},null!==s.cleanValue?(h&&void 0===l.radius&&(s.radius=c+(a-c)*(s.cleanValue-d)/(p-d)),n=Number(s.radius),s=(Number(l.x)+e)*t,l=(Number(l.y)+o)*t,f=y(f,s-n),m=y(m,l-n),v=k(v,s+n),b=k(b,l+n)):g?s.__hideMarker=!0:null===s.radius&&(s.radius=u);return{x:f,y:m,x1:v,y1:b}},_spaceManager:function(){var t,e,o=this.config,r=this.components.legend.config.legendPos,a=this.jsonData.chart,i=o.origMarginLeft,n=o.origMarginTop,l=this.baseWidth,s=this.baseHeight,h={},c=0,d=0;h=o.markerOpts,a=o.borderWidth=o.showBorder?E(a.borderthickness,1):0;this._allocateSpace({top:a,bottom:a,left:a,right:a}),this._allocateSpace(this._manageActionBarSpace&&this._manageActionBarSpace(.225*o.availableHeight)||{}),this._manageLegendSpace("right"===r?.3*o.canvasWidth:.3*o.canvasHeight),r=this._manageChartMenuBar("bottom"===r?.225*o.canvasHeight:.225*o.canvasWidth),a=o.canvasWidth,t=o.canvasHeight,h.dataEnabled?(o.adjustViewPortForMarkers?((h=this.preliminaryScaling()).x1>l&&(l=h.x1),h.x<0&&(l+=-h.x,c=-h.x),h.y1>s&&(s=h.y1),h.y<0&&(s+=-h.y,d=-h.y),o=this.getScalingParameters(l,s,a,t),h=this.calculateMarkerBounds(o.scaleFactor*this.baseScaleFactor,c,d),o=t,e=a,h.x<0&&(i+=-h.x,a+=h.x),h.y<0&&(n+=-h.y,t+=h.y),h.x1>e&&(a-=h.x1-e),h.y1>o&&(t-=h.y1-o)):(o=this.getScalingParameters(l,s,a,t),this.calculateMarkerBounds(o.scaleFactor*this.baseScaleFactor,c,d)),i+=c*(o=this.getScalingParameters(l,s,a,t)).scaleFactor*this.baseScaleFactor,n+=d*o.scaleFactor*this.baseScaleFactor):o=this.getScalingParameters(l,s,a,t),l=(this.config.scalingParams=o).scaleFactor,o.translateX+=i,o.translateY=o.translateY+n+r.top||0,o.sFactor=l*this.baseScaleFactor*100/100,o.transformStr=["t",o.translateX,",",o.translateY,"s",l,",",l,",0,0"].join(""),this.config.annotationConfig={id:"geo",showbelow:0,autoscale:0,grpxshift:o.translateX?o.translateX:0,grpyshift:o.translateY?o.translateY:0,xscale:100*(l?l*this.baseScaleFactor:1),yscale:100*(l?l*this.baseScaleFactor:1),options:{useTracker:!0}},this.components.mapAnnotations.reset(null,this.config.annotationConfig,this),this.components.mapAnnotations._renderer&&(this.components.mapAnnotations._renderer=null)},getDataLimits:function(){var t,e,o=this.components.dataset,r=o.length,a=1/0,i=-1/0;for(e=0;e<r;e++)t=(t=o[e]).getDataLimits(),a=y(a,t.min),i=k(i,t.max);return{dataMin:a,dataMax:i}},getEntityPaths:function(t){var e,o={},r=this.entities;if(t){for(e in r)o[e]=r[e];return o}return r},checkComplete:function(){var o,r,a,i,n=this,t=n.getJobList(),l=n.components.mapAnnotations,s=n.components.mapLabelAnnotations||[],h=s.length,e=function(t,e){return function(){if(o.draw.call(t,e,!0),n.config.labelDrawCount++,n.config.labelDrawCount===h&&c&&(a=l.groups&&l.groups[0]&&l.groups[0].wrapper))for(r=0;r<h;r++)(i=s[r].groups[0]&&s[r].groups[0].wrapper)&&i.insertAfter(a)}},c=n.config.entityOpts.labelsOnTop;if(n.config.labelDrawCount=0,n.config.entityFlag&&n.config.entitiesReady){for(n.config.entityFlag=!1,r=0;r<h;r++)o=s[r],t.labelDrawID.push(f.addJob(e(o,n),m.priorityList.label,!0));l.draw(n),n.config.markersDrawn=!0,C.raiseEvent("internal.mapdrawingcomplete",{renderer:n},n.chartInstance)}},colorPaletteMap:{basefontcolor:"foregroundcolor",bordercolor:"foregrounddarkcolor",borderalpha:"foregrounddarkalpha",bgcolor:"backgroundlightcolor",bgalpha:"backgroundlightalpha",bgangle:"backgroundlightangle",bgratio:"backgroundlightratio",canvasbordercolor:"foregrounddarkcolor",canvasborderalpha:"foregrounddarkalpha",canvasbgcolor:"backgroundlightcolor",canvasbgalpha:"backgroundlightalpha",canvasbgangle:"backgroundlightangle",canvasbgratio:"backgroundlightratio",tooltipbordercolor:"foregrounddarkcolor",tooltipborderalpha:"foregrounddarkalpha",tooltipbgcolor:"backgroundlightcolor",tooltipbgalpha:"backgroundlightalpha",tooltipfontcolor:"foregroundcolor",legendbordercolor:"foregrounddarkcolor",legendborderalpha:"foregrounddarkalpha",markerbordercolor:"foregroundlightcolor",markerborderalpha:"foregroundlightalpha",markerfillcolor:"backgrounddarkcolor",markerfillalpha:"backgrounddarkalpha",markerfillangle:"backgrounddarkangle",markerfillratio:"backgrounddarkratio",plotfillcolor:"backgroundcolor",plotfillalpha:"backgroundalpha",plotfillangle:"backgroundangle",plotfillratio:"backgroundratio",plothoverfillcolor:"backgrounddarkcolor",plothoverfillalpha:"backgrounddarkalpha",plothoverfillangle:"backgrounddarkangle",plothoverfillratio:"backgrounddarkratio",plotbordercolor:"foregroundcolor",plotborderalpha:"foregroundalpha",shadow:"shadow"},eiMethods:{getMapName:function(){var t=this.jsVars.instanceAPI;return"string"==typeof t.name&&t.name.toLowerCase()},getEntityList:function(){var t,e,o,r=this.jsVars.instanceAPI.components.dataset||[],a=r.length,i=[];for(t=0;t<a;t++)if("entity"===(o=r[t]||[]).type){e=o;break}for(t in r=e.components.data)r.hasOwnProperty(t)&&(e=(e=r[t]||{}).config||{},i.push({id:e.id,originalId:e.originalId||e.id,label:e.label,shortlabel:e.shortLabel,value:e.value,formattedValue:e.formattedValue,toolText:e.toolText}));return i},getMapAttribute:function(){return C.raiseWarning(this,"12061210581","run","JavaScriptRenderer~getMapAttribute()",'Use of deprecated "getMapAttribute()". Replace with "getChartAttribute()".'),this.getChartAttribute.apply(this,arguments)},exportMap:function(){return C.raiseWarning(this,"12061210581","run","JavaScriptRenderer~exportMap()",'Use of deprecated "exportMap()". Replace with "exportChart()".'),this.exportChart&&this.exportChart.apply(this,arguments)},addMarker:function(t){var e,o,r,a=this.jsVars.instanceAPI.components.dataset||[],i=a.length;for(e=0;e<i;e++)if("markers"===(o=a[e]||[]).type){r=o;break}r&&!r.addMarkerItem(t)&&C.raiseWarning(this,"1309264086","run","MapsRenderer~addMarker()","Failed to add marker. Check the options and try again.")},updateMarker:function(t,e){var o,r,a,i=this.jsVars.instanceAPI.components.dataset||[],n=i.length;for(o=0;o<n;o++)if("markers"===(r=i[o]||[]).type){a=r;break}a&&t&&(t=(t+"").toLowerCase(),a.updateMarkerItem(t,e))},removeMarker:function(t){var e,o,r,a=this.jsVars.instanceAPI.components.dataset||[],i=a.length;for(e=0;e<i;e++)if("markers"===(o=a[e]||[]).type){r=o;break}t&&(t=(t+"").toLowerCase(),r._removeMarkerItem(t))}},_createAxes:function(){}},n.mscartesian),K.register("component",["caption","MapCaption",{configure:function(){var t=(o=this.chart).jsonData.chart,e=(n=o.components).caption.config,o=(a=o.config.style).outCanfontFamily,r=a.outCancolor,a=a.fontSize,i=["top","center"],n=n.subCaption.config;switch(e.style={fontFamily:L(t.captionfont,o),color:T(L(t.captionfontcolor,r).replace(/^#? ([a-f0-9]+)/gi,"#$1")),fontSize:E(t.captionfontsize,a+3)+"px",fontWeight:0===E(t.captionfontbold)?"normal":"bold"},e.align=n.align=L(t.captionposition,"center"),e.align&&((i=e.align.split("-"))[0]&&(i[0]=i[0].toLowerCase()),i[1]&&(i[1]=i[1].toLowerCase())),e.isOnTop="bottom"===i[0]?n.isOnTop=0:n.isOnTop=1,i[1]){case"right":e.align="end";break;case"left":e.align="start";break;default:e.align="middle"}e.alignWithCanvas=n.alignWithCanvas=E(t.aligncaptionwithcanvas,1),e.horizontalPadding=n.horizontalPadding=E(t.captionhorizontalpadding,e.alignWithCanvas?0:15),e.drawCaption=!0,l(e.style),n.style={fontFamily:L(t.subcaptionfont,t.captionfont,o),color:T(L(t.subcaptionfontcolor,t.captionfontcolor,r).replace(/^#? ([a-f0-9]+)/gi,"#$1")),fontSize:E(t.subcaptionfontsize,E(k(E(t.captionfontsize)-3,-1),a)+E(this.subTitleFontSizeExtender,1))+"px",fontWeight:0===E(t.subcaptionfontbold,this.subTitleFontWeight,t.captionfontbold)?"normal":"bold"},l(n.style)}},"Caption"]),K.register("component",["dataset","Entities",{customConfigFn:"_createDatasets",type:"entity",pIndex:2,configure:function(){var t,e,o=(n=this.chart).jsonData,r=this.conf,a=n.components,i=o.map||o.chart,n=m.nonGradientColorRange,l=(o.colorrange||{}).gradient,s=a.postLegendInitFn,h=a.numberFormatter,c={};a=o.entitydef||[];for(t=o.data&&o.data[0]&&o.data[0].data?this.JSONData=o.data[0].data||[]:this.JSONData=o.data||[],r.useSNameAsId=E(i.usesnameasid,0),this._redefineEntities(a),a=this.components.data,r.showTooltip=E(i.showtooltip,1),r.showHoverEffect=E(i.showhovereffect,0),t=(r=t)&&r.length||0,i={};t--;)void 0!==(c=r[t]).id&&(i[c.id.toLowerCase()]=c);for(e in t=i,this.calculateDataLimits(),c=this.getDataLimits(),l?s({min:c.min,max:c.max}):this.components.colorRange=new n({colorRange:o.colorrange,dataMin:c.min,dataMax:c.max,defaultColor:"#00ff00",numberFormatter:h}),a)o=t[e],(n=a[e]).dataset=this,o?this._configureEntity(e,n,d(this._sanitizeEntityOptions(A({},o)),n.config)):this._configureEntity(e,n,n.config);this._addLegend()},init:function(t){this.JSONData={data:t},this.components={},this.conf={},this.graphics={},this.configure()},updateEntityColors:function(t,e){var o,r,a,i,n=this.components.data,l=this.chart,s={"fill-opacity":0};for(i in n)a=(r=(o=n[i]).config).cleanValue,r={"fill-opacity":(r=r.alphaArr||[])[0]/100||1},a<t||e<a?(this.setCustomAttrs(o,s,l),o.hidden=!0):(o.hidden=!1,this.setCustomAttrs(o,r,l))},_addLegend:function(){var t,e,o,r,a,i=this.chart.components.legend,n=(this.components.colorRange||{}).colorArr||[],l=this.components.entityColorMap=this.components.entityColorMap||(this.components.entityColorMap=[]),s=n.length;for(i.emptyItems(),e=l.length=0,s=n.length;e<s;e++)t=n[e],r=L(t.code,t.color),o=h(r,60).replace(c,p),a=h(r,40),o={fillColor:O(r={FCcolor:{color:r+","+r+","+a+","+r+","+r,ratio:"0,70,30",angle:270,alpha:"100,100,100,100,100"}}),label:L(t.label,t.displayvalue),strokeColor:O(o),legendItemId:t.legendItemId},(r=l[e])||(r=l[e]={config:{}}),r.config=t,r.visible=!0,r.dataset=this,r.legendItemId=i.addItems(r,this.legendInteractivity,o)},legendInteractivity:function(t,e){var o,r,a,i=this.config,n=t.config,l=t.visible,s=t.dataset,h=s.chart,c=s.components.data,d=e.config,p=e.graphics,g=s.components.colorRange,u=i.itemHiddenStyle.color,f=(i=i.itemStyle.color,d.fillColor);r={};var m,v={},b={"fill-opacity":0},y=d.strokeColor;for(o in t.visible=!l,c)c.hasOwnProperty(o)&&(a=(d=(r=c[o]).config).cleanValue,a=g.getColorObj(a),d=d.visibleEntityAttr,v["fill-opacity"]=d["fill-opacity"],d=l?b:v,n.code===a.code&&(r.hidden=!!l,s.setCustomAttrs(r,d,h)));for(m in r={legendItemSymbol:{fill:l?u:f,stroke:l?u:y},legendItemText:{fill:l?u:i},legendIconLine:{stroke:l?u:f}},p)(n=p[m])&&n.attr&&n.attr(r[m])},setCustomAttrs:function(t,e,o){var r=o.get("config","animationObj");o=r.transposeAnimDuration,r=r.animType,t&&(t=(t=t.graphics).outlines).animate(e,o,r)},calculateDataLimits:function(){var t,e,o,r=this.chart,a=this.conf,i=r.jsonData.data||[],n=(r=r.components.numberFormatter,1/0),l=-1/0;for(o=0,e=i.length;o<e;o++)t=i[o].value,t=r.getCleanValue(t),n=y(n,t),l=k(l,t);a.max=l,a.min=n},_configureEntity:function(t,e,o){var r,a=this.chart,i=this.conf,n=a.jsonData,l=(u=a.components).numberFormatter,s=a.config.entityOpts,h=e.config,c=(a=e.labelConfig,o.value),d=n.colorrange&&n.colorrange.gradient,p=(u=u.gradientLegend)&&u.colorRange,g=this.components.colorRange,u=h.cleanValue=l.getCleanValue(c),f=h.formattedValue=void 0!==u?l.dataLabels(u):void 0,m=(l=E(o.showtooltip,s.showTooltip),n=this._getDefaultTooltip.call(e,o,this),f={formattedValue:f,sName:o.shortLabel,lName:o.label},s.dataLabels.style),v=(l=h.toolText=l?I(L(F(L(o.tooltext,s.tooltext,n),[1,2,7,38,39],f,o))):"",n=h.borderColor=L(o.bordercolor,s.borderColor),f=h.borderAlpha=L(o.borderalpha,s.borderAlpha),h.borderThickness=E(o.borderthickness,s.borderThickness)),b=h.useHoverColor=E(o.showhovereffect,o.usehovercolor,s.hoverOnNull?s.showHoverEffect:isNaN(c)?0:s.showHoverEffect);c=h.labelAlignment;if(e.hidden=!1,h.showLabel=E(o.showlabel,s.showLabels),h.labelPadding=E(o.labelpadding,s.labelPadding),h.fontFamily=L(o.font,m.fontFamily),h.fontSize=E(parseInt(o.fontsize,10),parseInt(m.fontSize,10)),h.fontBold=E(o.fontbold,0),h.fontColor=L(o.fontcolor,m.color),h.connectorColor=L(o.labelconnectorcolor,s.connectorColor),h.connectorAlpha=L(o.labelconnectoralpha,s.connectorAlpha),h.hoverBorderThickness=E(o.borderhoverthickness,o.hoverborderthickness,s.hoverBorderThickness),h.hoverBorderColor=L(o.borderhovercolor,o.hoverbordercolor,s.hoverBorderColor,h.borderColor),h.hoverBorderAlpha=L(o.borderhoveralpha,o.hoverborderalpha,s.hoverBorderAlpha,h.borderAlpha),h.connectorThickness=E(o.labelconnectorthickness,s.connectorThickness),h.origConnectorThickness=h.connectorThickness,h.borderThickness=v,h.link=o.link,h.isVisible=!0,h.id=t,h.originalId=o.origId,null!==u&&(p&&d?r=p.getColorByValue(u):g&&(t=g.getColorObj(u),r=L(t.color,t.code))),void 0!==L(o.color,o.alpha,o.angle,o.ratio)?(r=L(o.color,r,s.fillColor),t=L(o.alpha,s.fillAlpha),u=L(o.angle,s.fillAngle),d=L(o.ratio,s.fillRatio),r=M({color:r,alpha:t,angle:u,ratio:d})):(r=M({color:L(r,s.fillColor),alpha:L(s.fillAlpha),angle:L(s.fillAngle),ratio:L(s.fillRatio)}),t=M({color:L(s.nullEntityColor),alpha:L(s.nullEntityAlpha),angle:L(s.nullEntityAngle),ratio:L(s.nullEntityRatio)}),t=(r=null===u?t:r).FCcolor.alpha),""===l&&(i.showTooltip=0),h.visibleEntityAttr={stroke:T(n,f),fill:(h.fillColor=r).toString(),"fill-opacity":t/100},i=t.split(","),h.alphaArr=i,b&&(void 0!==L(o.fillhovercolor,o.fillhoveralpha,o.fillhoverangle,o.fillhoverratio,o.hoverfillcolor,o.hoverfillalpha,o.hoverfillratio,o.hoverfillangle)?(r=L(o.fillhovercolor,o.hoverfillcolor,s.hoverFillColor),t=L(o.fillhoveralpha,o.hoverfillalpha,s.hoverFillAlpha),u=L(o.fillhoverangle,o.hoverfillangle,s.hoverFillAngle),d=L(o.fillhoverratio,o.hoverfillratio,s.hoverFillRatio),i=M({color:r,alpha:t,angle:u,ratio:d})):(s.hoverColorObject||(s.hoverColorObject=M({color:s.hoverFillColor,alpha:s.hoverFillAlpha,angle:s.hoverFillAngle,ratio:s.hoverFillRatio})),i=s.hoverColorObject),h.hoverColor=i),!a&&(a=e.labelConfig={}),s=h.fontColor,t=h.fontFamily,r=h.fontBold,l=h.toolText,u=h.link,c?(i=c[0],c=c[1]):(i="center",c="middle"),a.align=i,a.vAlign=c,a.bgColor="",a.borderColor="",a.fontColor=s,a.fontFamily=t,a.fontBold=r,a.toolText=l,a.link=u,"object"==typeof h.options)for(u=h.entityLabels=h.entityLabels||[],f=(n=h.labels||[]).length;f--;)u[f]||(u[f]={config:{}}),a=u[f].config,(c=n[f].labelAlignment)?(i=c[0],c=c[1]):(i="center",c="middle"),a.align=i,a.vAlign=c,a.displayValue=this.getDisplayValue.call(e,n[f],h.options.isDataEnabled,!f,o),a.bgColor="",a.borderColor="",a.toolText=l,a.align=i,a.vAlign=c,a.bgColor="",a.borderColor="",a.fontColor=s,a.fontFamily=t,a.fontBold=r,a.toolText=l;else h={shortText:h.shortLabel,text:h.label},a.displayValue=this.getDisplayValue.call(e,h,!0,!0,o)},getDisplayValue:function(t,e,o,r){var a=this.dataset.chart.config.entityOpts,i=this.config,n=i.cleanValue,l=i.formattedValue,s=a.labelSepChar;return e?o&&void 0!==r.displayvalue?t=r.displayvalue:(t=L(a.includeNameInLabels?a.useShortName?t.shortText:t.text:""),a.includeValueInLabels&&null!==n&&(t=void 0===t?l:t+s+l)):t=i.label,t},_sanitizeEntityOptions:function(t){return delete t.outlines,delete t.label,delete t.shortlabel,delete t.labelposition,delete t.labelalignment,delete t.labelconnectors,t},_redefineEntities:function(t){var e,o,r,a,i,n,l,s,h,c=this.conf,d={},p={},g=this.chart.entities,u=c.useSNameAsId,f=0;for(e=t.length;e--;)if(r=(o=t[e]).internalid,a=o.newid?o.newid:r,i=o.sname,n=o.lname,s=g[r],r=m.trimString(r),a=(a=m.trimString(a))&&a.toLowerCase(),s){for(h in d[a]=a={origId:r},p[r]=!0,s)a[h]=s[h];a.shortLabel=i||s.shortLabel,a.label=n||s.label,a.showhovereffect=o.showhovereffect,a.fillhovercolor=o.fillhovercolor,a.fillhoveralpha=o.fillhoveralpha,a.fillhoverangle=o.fillhoverangle,a.fillhoverratio=o.fillhoverratio,a.borderhoverthickness=o.borderhoverthickness}for(l in(s=this.components.data)||(s=this.components.data={}),d)s[l=l.toLowerCase()]||(s[l]={config:{}}),s[l].config=d[l],f+=1;for(l in d=s,g)if(a=g[l],!p[l=m.trimString(l)]){for(h in u?((s=d[a.shortLabel.toLowerCase()])||(s=d[a.shortLabel.toLowerCase()]={}),s.config={},s.origId=a.shortLabel):((s=d[l.toLowerCase()])||(s=d[l.toLowerCase()]={}),s.config={},s.config.origId=l),a)s.config[h]=a[h];f+=1}c.entityCount=f},draw:function(){var t=this.conf,e=this.chart,o=S?200:10;this.conf.ready=!1,t.BATCH_SIZE=o,t.labelBatchSize=S?200:20,this._batchRender()(0),e.config.entityFlag=!0},_batchRender:function(){var e,o,r,a,i,n=this,t=n.conf,l=(s=n.chart).getJobList(),s=s.entities.firstEntity,h=n.components.data,c=t.BATCH_SIZE,d=t.entityKeys=s?n._getKeys(s,h):Object.keys(h),p=t.entityLength=d.length,g=function(t){return function(){u(t)}},u=function(t){for(e=t,r=0;void 0!==d[e];)if(o=h[d[e]],i=n.drawEntity(o,c),r+=i,o.config.drawn&&((a=e===p-1?o:h[d[e-1]])&&(a.config.drawn=!1,a.config.outlineStartIndex=void 0),e++),c<=r){l.entityDrawID.push(f.addJob(g(e),m.priorityList.entitydraw,void 0,!0));break}e===p&&(n._addEventListenersToEntities(0),n.initComplete())};return u},_addEventListenersToEntities:function(t){for(var e,o,r=this,a=r.components.data,i=r.chart.getJobList(),n=(s=r.conf).BATCH_SIZE,l=s.entityKeys,s=s.entityLength,h=0,c=function(t){return function(){r._addEventListenersToEntities(t)}};t<s;t++)if((o=(o=(e=a[l[t]]).config).options)&&!1===o.isDataEnabled||r.addMouseGestures.call(e),++h===n){i.entityDrawID.push(f.addJob(c(t),m.priorityList.entitydraw));break}},_getKeys:function(t,e){for(var o=[t],r=t;e[r];)r=e[r].nextId,o.push(r);return o},_getDefaultTooltip:function(t){var e=this.config.cleanValue,o=this.config.formattedValue,r=this.dataset.chart.config.entityOpts;if("object"==typeof this.config.options){if(!(t=t.labels&&t.labels[0]))return;e=(r.useSNameInTooltip?t.shortText:t.text)+(null===e?"":r.tooltipSepChar+o)}else e=(r.useSNameInTooltip?t.shortLabel:t.label)+(null===e?"":r.tooltipSepChar+o);return e},drawEntity:function(t,e){var o,r,a,i,n,l,s,h,c,d=(b=this.chart).components.paper,p=t.config,g=S||!x?"litepath":"path",u=p.outlines,f=b.graphics.datasetGroup,m=b.graphics.shadowGroup,v=p.toolText,b=b.config.entityOpts.shadow,y=[];if(this._configureEntityDrawingParams(t),a=(p=t.config).visibleEntityAttr,c=p.shadowOptions,r=p.fillOpacity,o=void 0===p.outlineStartIndex?u.length:p.outlineStartIndex,t.graphics||(t.graphics={}),s=0,y=p.outlinePath||(p.outlinePath=[]),h=p.customStrokeWidthModifier,"object"==typeof p.options){for(;o--;){if(y=u[o].outline,!0===p.options.isDataEnabled)i=a;else{i=A({},a);var k=void 0,w={};if(l=(l=h)||1,(n=u[o].style)&&"object"==typeof n)for(k in n)_.test(k)||("stroke-width"===k?(w[k]=Number(n[k])/l,R&&(w[k]=w[k]&&P(w[k])||0)):w[k]=n[k]);i=A(i,n=w)}if((n=t.graphics.outlines)||(n=t.graphics.outlines=[]),!n[o]&&(n[o]={}),(l=n[o].outline)?l.attr({"fill-opacity":r}):l=n[o].outline=d[g](y,f),l.attr(i).tooltip(v).shadow(!!b&&c,m),s++,p.outlineStartIndex=o,s===e)return s}p.drawn=!0}else{if(t.graphics.outlines)t.graphics.outlines.attr(a).attr({"fill-opacity":r});else{for(;o--;)if(y=(r=u[o]).concat(y),s++,p.outlineStartIndex=o,s===e)return p.outlinePath=y,s;t.graphics.outlines=d[g](y,f).attr(a)}p.drawn=!0,p.outlineStartIndex=0,p.outlinePath=[],t.graphics.outlines.tooltip(v).shadow(!!b&&c,m)}return s},_configureEntityDrawingParams:function(t){var e=this.chart,o=e.config,r=e.components.gradientLegend,a=t.config,i=e.config.scalingParams,n=!x||S,l=i.scaleFactor,s=i.strokeWidth,h=(n?e.baseScaleFactor:1)*s,c=1===e.config.entityOpts.scaleBorder,d=a.borderThickness,p=a.origConnectorThickness,g=a.hoverBorderThickness,u=a.visibleEntityAttr,f=u["fill-opacity"];a.shadowOptions={scalefactor:[l,l*e.baseScaleFactor],opacity:k.apply(v,a.alphaArr)/100},r&&!0===o.gLegendEnabled&&(t.hidden=!1),a.fillOpacity=t.hidden?0:f,r&&r.enabled&&(r.resetLegend(),r.clearListeners()),r&&r.notifyWhenUpdate(this.updateEntityColors,this),n?(d=a.entityBorderThickness=c?d*h:d/l,p/=l,t=c?l:i.sFactor,g&&(a.hoverBorderThickness=c?g*h:g/l)):(d=c?d*s:d,t=c?i.scaleFactor:e.baseScaleFactor),a.entityBorderThickness=d,a.connectorThickness=p,a.customStrokeWidthModifier=t,u["stroke-width"]=d,u.transform=S||!x?"":i.transformStr},drawLabels:function(t){var e,o=t.chart,r=(i=t.conf).labelBatchSize,a=o.components,i=i.entityLength,n=[],l=0,s=0,h=0,c=o.config.annotationConfig,d=a.mapLabelAnnotations=a.mapLabelAnnotations||(a.mapLabelAnnotations=[]);for(e in(a=d[l])||(a=d[l]=new m.Annotations),a.reset(null,c,o),a._renderer&&(a._renderer=null),this)t.drawLabel.call(this[e],n),++l===r?(a.addGroup({id:"entityLabels",items:n}),(a=d[++s])||(a=d[s]=new m.Annotations),a.reset(null,c,o),a._renderer&&(a._renderer=null),l=0,n=[]):h===i-1&&a.addGroup({id:"entityLabels",items:n}),h++;t.drawLabelConnFn(0)},drawLabelConnFn:function(t){for(var e,o,r,a=this,i=a.conf,n=a.chart.getJobList(),l=a.components.data,s=i.BATCH_SIZE,h=(i=i.entityKeys).length,c=function(t){return function(){a.drawLabelConnFn(t)}},d=0;t<h;t++){if("object"==typeof(e=(r=l[i[t]]).config).options)for(e=(o=e.labels)&&o.length||0;e--;)o[e].labelConnectors&&(a.drawLabelConnectors.call(r,o[e].labelConnectors),d++);else e.labelConnectors&&(a.drawLabelConnectors.call(r,e.labelConnectors),d++);if(d===s){n.entityDrawID.push(f.addJob(c(t),m.priorityList.entitydraw,void 0,!0));break}}},_getLabelObject:function(t,e){var o,r,a,i,n,l=this,s=l.dataset,h=s.chart,c=l.config,d=h.config.scalingParams,p=l.graphics&&l.graphics.outlines,g=c.fontSize,u=c.labelPadding;return a=c.labels||[],o=c.entityLabels||[],void 0!==t?(a=a[t],i=(o=(i=o[t]).config).style=a.style,r=a.labelPosition,a=a.labelAlignment):(o=l.labelConfig,r=c.labelPosition,a=c.labelAlignment),r?(p=r[0],r=r[1]):(p=(r=p.getBBox()).x+r.width/2,r=r.y+r.height/2),a?("right"===(n=a[0])?p-=u:"left"===n&&(p+=u),"top"===(a=a[1])?r-=u:"bottom"===a&&(r+=u)):(n="center",a="middle"),g=parseFloat(g)/d.sFactor,!e&&i&&(i.color&&(o.fontColor=i.color),i["font-size"]&&(g=parseFloat(i["font-size"])/d.sFactor),i["font-family"]&&(o.fontFamily=i["font-family"]),void 0!==i["font-weight"]&&(o.fontBold="bold"===i["font-weight"])),o.x=p.toString(),o.y=r.toString(),o.wrap=1,o.type="text",o.fontSize=g,{x:p.toString(),y:r.toString(),wrapwidth:B[n](void 0,p+void 0)-u,wrapheight:D[a](void 0,r+void 0)-u,wrap:1,type:"text",align:o.align,valign:o.vAlign,text:o.displayValue,tooltext:o.toolText,link:o.link,bgcolor:o.bgColor,bordercolor:o.borderColor,fillcolor:o.fontColor,fontsize:o.fontSize,font:o.fontFamily,bold:o.fontBold,onclick:function(t){C.raiseEvent("entityclick",c.eventArgs,h.chartInstance,t)},onmouseover:function(t){var e,o,r=l.graphics.outlines;if(r instanceof Array)for(e=0,o=r.length;e<o;e++)s.entityRollOver.call(r[e].outline,t);else s.entityRollOver.call(r,t)},onmouseout:function(t){var e,o,r=l.graphics.outlines;if(r instanceof Array)for(e=0,o=r.length;e<o;e++)s.entityRollOut.call(r[e].outline,t);else s.entityRollOut.call(r,t)},ontouchstart:function(t){var e,o,r=l.graphics.outlines;if(r instanceof Array)for(e=0,o=r.length;e<o;e++)s.entityRollOver.call(r[e].outline,t);else s.entityRollOver.call(r,t);s.entityRollOver.call(r,t)}}},drawLabel:function(t){var e,o=this.dataset,r=this.config;if(r.showLabel)if("object"==typeof r.options)for(e=(e=r.labels)&&e.length||0,r=r.options.isDataEnabled;e--;)t.push(o._getLabelObject.call(this,e,r,!e));else t.push(o._getLabelObject.call(this,void 0,!0,!0))},drawLabelConnectors:function(t){for(var e,o,r=this.config,a=(n=this.dataset.chart).components.paper,i=n.config.scalingParams,n=n.graphics.datasetGroup,l=t&&t.length||0,s=r.showLabel;l--;)o=t[l],e=this.graphics.connectorElem,s?(e||(this.graphics.connectorElem=e=a.path(o,n)),e.show().attr({transform:S||!x?"":i.transformStr,stroke:T(r.connectorColor,r.connectorAlpha),"shape-rendering":"crisp","stroke-width":r.connectorThickness})):e&&e.hide()},entityClick:function(t){var e,o=(e=this.node.__entity).dataset.chart,r=o.linkedItems.linkClickFN,a=(e=e.config).link;C.raiseEvent("entityclick",e.eventArgs,o.chartInstance,t),void 0!==a&&r.call({link:a},o)},entityRollOver:function(t){var e=this.node.__entity,o=e.config,r=e.dataset.chart,a=o.hoverAttr;m.plotEventHandler.call(this,r,t,"entityRollOver"),this.data("hovered")?clearTimeout(e.config.timer):o.useHoverColor&&o.isVisible&&!e.hidden&&((r.config.hoverEntity=this).attr(a),this.data("hovered",!0))},entityRollOut:function(t){var e=this,o=this.node.__entity,r=o.config.revertAttr;m.plotEventHandler.call(e,o.dataset.chart,t,"entityRollOut"),o.config.timer=setTimeout(function(){!0!==o.hidden&&(e.attr(r),e.data("hovered",!1))},100)},addMouseGestures:function(){var t,e=this,o=e.config,r=e.dataset,a=e.graphics,i=o.hoverBorderThickness,n=o.hoverBorderColor,l=o.hoverBorderAlpha,s=o.entityBorderThickness,h=o.borderColor,c=o.borderAlpha,d=o.link,p=o.visibleEntityAttr,g="groupId"+o.originalId,u=function(t){void 0!==d&&t.css({cursor:"pointer",_cursor:"hand"}),t.data("eventArgs",o.eventArgs),t.data("groupId",g),(t.node.__entity=e)._listenersBinded||t.click(r.entityClick).hover(r.entityRollOver,r.entityRollOut)};for(t in o.eventArgs={value:o.cleanValue,label:o.label,shortLabel:o.shortLabel,originalId:o.origId,id:o.id||o.origId},o.legacyEventArgs={value:o.value,lName:o.label,sName:o.shortLabel,id:o.originalId||o.id},o.hoverAttr={fill:O(o.hoverColor)},o.revertAttr={fill:O(o.fillColor),stroke:O(o.borderColor,o.borderAlpha)},o.revertAttr["fill-opacity"]=p["fill-opacity"],i!==s&&(o.hoverAttr["stroke-width"]=E(i,s),o.revertAttr["stroke-width"]=s),n===h&&l===c||(o.hoverAttr.stoke=T(n,l),o.revertAttr.stroke=T(h,c)),a)if(a.hasOwnProperty(t)){if(a[t]instanceof Array)for(i=0,l=(s=a[t]).length;i<l;i++)u(n=s[i].outline);else u(n=a[t]);e._listenersBinded=!0}},getDataLimits:function(){var t=this.conf;return{max:t.max,min:t.min}},initComplete:function(){var t=this.chart;this.drawLabels.call(this.components.data,this),t.config.entitiesReady=!0,t.checkComplete()}}]),K.register("component",["dataset","Markers",{type:"markers",configure:function(){var t=this.chart.config.markerOpts;this.calculateDataLimits(),t.dataEnabled?this._parseMarkers():this.defineMarkersNShapes(),this.configureConnectors()},init:function(t){this.JSONData=t,this.components={},this.conf={},this.graphics={},this.configure()},calculateMarkerRadiusLimits:function(){var t=this.JSONData,e=this.conf,o=this.chart;t=this.getMarkerRadiusLimits(o.config.width,o.config.height,t.markermaxradius,t.markerminradius);e.minRadius=t.min,e.maxRadius=t.max},calculateDataLimits:function(){var t,e,o,r=this.chart,a=this.conf,i=(r.jsonData.markers||{}).items||[],n=(r=r.components.numberFormatter,1/0),l=-1/0;for(o=0,e=i.length;o<e;o++)t=(t=i[o]).value,null!==(t=r.getCleanValue(t))&&(n=y(t,n),l=k(t,l));a.min=n,a.max=l},_parseMarkers:function(){var t,e,o,r,a,i,n,l=this.chart,s=(c=l.jsonData.markers).items,h=c.shapes,c=l.config.markerOpts,d=l.components.numberFormatter,p=this.components.shapeObjs=this.components.shapeObjs||(this.components.shapeObjs={}),g=this.components.markerObjs=this.components.markerObjs||(this.components.markerObjs={});if(s&&s.length){if(h&&h.length)for(t=h.length;t;--t)(n=(o=h[t-1]).id.toLowerCase())&&(p[n]=o);for(t=s.length;t--;)(n=(o=s[t]).id&&o.id.toLowerCase())&&(void 0!==(h=o.value)&&""!==h&&(h=parseFloat(h)),(r=(e=this._initializeMarkerItem(n,o,null,l)).config.options.shapeid)&&"string"==typeof r&&(r=r.toLowerCase()),i=(a=e.config).options,a.cleanValue=d.getCleanValue(h),a.formattedValue=null!==a.cleanValue?d.dataLabels(h):void 0,a.fillColor=L(i.fillcolor,i.color,c.fillColor),a.fillAlpha=L(i.fillalpha,i.alpha,c.fillAlpha),a.fillRatio=L(i.fillratio,c.fillRatio),a.fillAngle=L(i.fillangle,c.fillAngle),a.borderThickness=E(i.borderthickness,c.borderThickness),a.borderColor=L(i.bordercolor,c.borderColor),a.borderAlpha=L(i.borderalpha,c.borderAlpha),a.labelPadding=i.labelpadding||c.labelPadding,e.dataset=this,o.__hideMarker&&(e._isHidden=!0),r&&(e.shapeObj=p[r]),g[n]=e)}},defineMarkersNShapes:function(){var t,e,o,r,a=this.chart,i=(d=a.jsonData.markers).definition,n=a.components.numberFormatter,l=a.config.markerOpts,s=G(i)||{},h=G(d.application)||{},c=d.shapes,d=this.components.shapeObjs=this.components.shapeObjs||(this.components.shapeObjs={}),p=this.components.markerObjs=this.components.markerObjs||(this.components.markerObjs={});if(i&&i.length){if(c&&c.length)for(i=c.length;i;--i)(r=(t=c[i-1]).id.toLowerCase())&&(d[r]=t);for(r in s)t=s[r],(i=p[r]=this._initializeMarkerItem(r,t,h[r],a)).dataset=this,o=i.config.options.shapeid,c=i.config,e=t.value,c.cleanValue=n.getCleanValue(e),t=c.options,c.formattedValue=null!==c.cleanValue?n.dataLabels(e):void 0,c.fillColor=L(t.fillcolor,t.color,l.fillColor),c.fillAlpha=L(t.fillalpha,t.alpha,l.fillAlpha),c.fillRatio=L(t.fillratio,l.fillRatio),c.fillAngle=L(t.fillangle,l.fillAngle),c.borderThickness=E(t.borderthickness,l.borderThickness),c.borderColor=L(t.bordercolor,l.borderColor),c.borderAlpha=L(t.borderalpha,l.borderAlpha),c.labelPadding=t.labelpadding||l.labelPadding,c.options.tooltext=L(t.tooltext,l.tooltext),c.link=t.link,o&&(i.shapeObj=d[o.toLowerCase()])}},getMarkerRadiusLimits:function(t,e,o,r){return t=.02*(e=y(t,e)),e*=.07,r=parseFloat(r),o=parseFloat(o),isNaN(r)||isNaN(o)?isNaN(r)?isNaN(o)?{min:t,max:e}:{min:parseInt(o/10,10),max:o}:{min:r,max:10*r}:r<o?{min:r,max:o}:{min:o,max:r}},getDataLimits:function(){var t=this.conf;return{min:t.min,max:t.max}},_initializeMarkerItem:function(t,e,o){var r={},a=r.config;return a||(a=r.config={}),a.id=t,a.definition=e,a.application=o,a.hasValue=null,a.value=null,a.options=null,a.label=null,a.markerShape=null,a.markerLabel=null,a.drawOptions={shape:null,label:null},a.drawComplete=!1,t=r.config.options=A({},a.definition),a.dataEnabled?isNaN(t.value)||""===t.value||(r.value=parseFloat(t.value),r.hasValue=!0):a.applyAll?a.options=A(t,a.application):o&&(a.options=A(t,a.application)),r},configureConnectors:function(){var t,e,o,r,a,i,n,l,s,h,c,d,p,g=this.chart,u=(u=g.jsonData.markers||{}).connector||u.connectors||[],f=this.components.markerObjs,m=u.length,v=this.components.connectors,b=function(r){return function(t){var e=t.data,o=e.wrapper;o&&e.options.hoverEffect&&o.attr(e.options._hoverAttrs),C.raiseEvent("connectorrollover",r,g.chartInstance,t)}},y=function(r){return function(t){var e=t.data,o=e.wrapper;o&&e.options.hoverEffect&&o.attr(e.options._defaultAttrs),C.raiseEvent("connectorrollout",r,g.chartInstance,t)}},k=function(e){return function(t){C.raiseEvent("connectorClick",e,g.chartInstance,t)}},w=g.config.connectorOpts,x={};for(v||(v=this.components.connectors=[]),p=0;p<m;p++)((d=u[p]).from||d.to)&&(e=f[d.from.toLowerCase()],o=f[d.to.toLowerCase()],e&&o&&(r=u[p].label,!(x=v[p])&&(x=v[p]={}),!x.config&&(t=x.config={}),!x.graphics&&(x.graphics={}),(t=x.config=A({},d)).fromMarker=e,t.toMarker=o,t.link=d.link,t.showTooltip=E(d.showtooltip,w.showTooltip),a=t.tooltext=t.showTooltip?L(d.tooltext,w.tooltext):"",i=t.thickness=L(d.thickness,w.thickness),n=t.color=L(d.color,w.color),l=t.alpha=L(d.alpha,w.alpha),t.hoverEffect=E(d.showhovereffect,w.showHoverEffect),s=L(d.hovercolor,w.hoverColor,n),h=L(d.hoveralpha,w.hoverAlpha,l),c=L(d.hoverthickness,w.hoverThickness,i),t.dashed=L(d.dashed,w.dashed),t.dashLen=E(d.dashlen,w.dashlen),t.dashGap=E(d.dashgap,w.dashgap),a&&(t.tooltext=a=I(F(a,[3,40,41,42,43],{label:r,fromId:e.config.definition.id,toId:o.config.definition.id,fromLabel:e.config.definition.label,toLabel:o.config.definition.label},void 0))),t.eventArgs={fromMarkerId:e.config.id,toMarkerId:o.config.id,label:r},t._hoverAttrs={stroke:M({color:s,alpha:h}).toString(),"stroke-width":c},t._defaultAttrs={stroke:M({color:n,alpha:l}).toString(),"stroke-width":i},t.type="line",t.onclick=k(t.eventArgs),t.onmouseover=b(t.eventArgs),t.onmouseout=y(t.eventArgs),r&&(!(t=x.labelConfig)&&(t=x.labelConfig={}),t.type="text",t.text=r,t.align="center",t.valign="middle",t.font=w.font,t.fillcolor=w.fontColor,t.bgcolor=w.labelBgColor,t.bordercolor=w.labelBorderColor,t.tooltext=w.tooltext)))},draw:function(){var t,e,o=this,r=o.chart,a=o.conf,i=r.components.mapAnnotations,n=o.components.markerObjs,l=(h=r.config).markerOpts,s=h.scalingParams,h=[],c=[],d=r.getJobList();for(t in o.imageLoadCount=0,o.imageCount=0,e=i.addGroup({items:c}),i=i.addGroup({fillalpha:"100",items:h}),o.components.markerGroup=i,o.components.markerLabelGroup=e,a.autoScale=l.autoScale?s.sFactor:1,n)a=null,(s=(l=n[t]).config).conIsHidden||(a=this._drawMarkerItem.call(l)),a&&(s._annotationIndex=h.length,l.markerShape=a.markerShape&&i.addItem(a.markerShape,!1,r),h.push(l.markerShape),l.markerLabel=a.markerLabel&&e.addItem(a.markerLabel,!1,r),c.push(l.markerLabel));this._drawConnectors(),d.kdTreeID.push(f.addJob(function(){o._buildKdTree()},m.priorityList.kdTree))},_buildKdTree:function(){var t,e=this.components.kdArrayMap,o=this.components.markerGroup,r=[],a=o&&o.items,i=a&&a.length||0;for(t=0;t<i;t++)e[o=a[t]._id]&&r.push(e[o]);this.components.kDTree||(this.components.kDTree=new V(!0)),this.components.kDTree._setSearchLimit(1/0,1/0),this.components.kDTree.buildKdTree(r)},_drawMarkerItem:function(){var t,e,n=this,l=n.dataset,o=(f=l.chart).config,r=l.conf,s=o.scalingParams,a=n.config,i=a.options,h=a.definition,c=o.markerOpts,d=(o=c.dataLabels.style,i.shapeid),p=i.scale||1,g=i.label||"",u=f.config.scalingParams.scaleFactor*f.baseScaleFactor,f=(i.labelpos||"top").toLowerCase(),m=a.formattedValue,v=i.tooltext,b=(r=E(h.radius,a.radius,c.radius)*p*r.autoScale||1e-4,h=a.fillColor,a.fillAlpha),y=a.fillRatio,k=a.fillAngle,w=a.borderThickness,x=a.borderColor,C=a.borderAlpha,S=l.components.kdArrayMap||(l.components.kdArrayMap={}),_=n.config.id;if(a.autoScale=c.autoScale?u:1,d)return v=v?I(F(v,[1,2,3],{formattedValue:m,label:g},i)):m?g+c.tooltipSepChar+m:g,null!=m?g=g+c.labelSepChar+m:isNaN(p)?p=1:p<0?p=0:5<p&&(p=5),A(i,{x:i.x.toString(),y:i.y.toString(),fillcolor:h,fillalpha:b,fillratio:y,fillangle:k,borderthickness:w,bordercolor:x,borderalpha:C,hovereffect:L(c.showHoverEffect),radius:r.toString(),link:i.link,showshadow:E(i.showshadow,a.shadow),_markerLabel:g,_markerId:i.id,id:(i.id+"").toLowerCase()}),delete i.tooltext,a.tooltext=!!c.showTooltip&&v,u=Number(i.x)*s.sFactor+s.translateX,m=Number(i.y)*s.sFactor+s.translateY,r=i.radius,"triangle"===d?(A(i,{type:"polygon",sides:3,startangle:c.startAngle}),p="polygon",t=3):"diamond"===d?(A(i,{type:"polygon",sides:4,startangle:c.startAngle}),p="polygon",t=4):"arc"===d?(A(i,{type:"arc",startangle:0,endangle:360,innerradius:e=.6*r}),p="arc"):"circle"===d?p=i.type="circle":(t=l.getShapeArgs.call(n),c.dataEnabled&&c.valueToRadius&&void 0!==i.radius?delete t.radius:(!t.radius&&(t.radius=c.radius),t.radius=t.radius*p*a.autoScale),A(i,t),i.id=i._markerId&&i._markerId.toLowerCase(),e=t.innerradius,r=t.radius,p=t.type,t=t.sides),A(i,{hoverfillcolor:L(i.fillhovercolor,c.hoverFillColor,i.fillcolor),hoverfillalpha:L(i.fillhoveralpha,c.hoverFillAlpha,i.fillalpha),hoverfillratio:L(i.fillhoverratio,c.hoverFillRatio,i.fillratio),hoverfillangle:L(i.fillhoverangle,c.hoverFillAngle,i.fillangle),hoverborderthickness:E(i.borderhoverthickness,c.hoverBorderThickness,i.borderthickness),hoverbordercolor:L(i.borderhovercolor,c.hoverBorderColor,i.bordercolor),hoverborderalpha:L(i.borderhoveralpha,c.hoverBorderAlpha,i.borderalpha)}),d={alpha:i.fillalpha,color:i.fillcolor,angle:360-i.fillangle,ratio:i.fillratio},v={alpha:i.hoverfillalpha,color:i.hoverfillcolor,angle:360-i.hoverfillangle,ratio:i.hoverfillratio},i._defaultattrs={fill:O(d),"stroke-width":"0"!==i.showborder?i.borderthickness:0,stroke:T(i.bordercolor,i.borderalpha)},i._hoverattrs={fill:O(v),"stroke-width":"0"!==i.showborder?i.hoverborderthickness:0,stroke:T(i.hoverbordercolor,i.hoverborderalpha)},"image"===i.type?(i.borderthickness=i.borderthickness||0,i.onload=function(t){var e=this.options,o=t.width;t=t.height;var r,a={},i=(Number(e.x)-o/(2*s.sFactor))*s.sFactor;e=(Number(e.y)-t/(2*s.sFactor))*s.sFactor;if((a=S[_]||(S[_]={})).x=i+s.translateX,a.y=e+s.translateY,a.element=n,a.shapeInfo={type:"rect",width:o,height:t},o&&t)for(r in{wrapper:1,tracker:1})this[r]&&this[r].attr({x:i,y:e,width:o,height:t});l.imageLoadCount++,l.imageLoadCount===l.imageCount&&l._buildKdTree()},i.onerror=function(){l.imageLoadCount++,l.imageLoadCount===l.imageCount&&l._buildKdTree()},l.imageCount++):((d=S[_]||(S[_]={})).x=u,d.y=m,d.element=n,d.shapeInfo={type:p,sides:t,radius:Number(r)+i.borderthickness/2,innerradius:e}),a.drawOptions.shape=i,c.showLabels?(e=i.labelpadding||c.labelPadding,t=(f=l._getLabelOptions(f,e,i)).align,r=f.valign,u=a._labelBaseWidth,p=a._labelBaseHeight,m=a._labelXOffset,d=a._labelYOffset,e<(u=c.labelWrapWidth?c.labelWrapWidth:l.getWrapWidth[t](u,Number(f.x)+m))&&(u-=e),e<(c=c.labelWrapHeight?c.labelWrapHeight:l.getWrapHeight[r](p,Number(f.y)+d))&&(c-=e),a.drawOptions.label=A({type:"text"},{text:g,tooltext:i.tooltext,x:f.x,y:f.y,align:t,valign:f.valign,wrap:1,wrapwidth:u,wrapheight:c,fontsize:o.fontSize/s.sFactor,font:o.fontFamily,fillcolor:o.fontColor}),{markerShape:i,markerLabel:a.drawOptions.label}):{markerShape:i}},getHoverFn:function(){var h=this.chart;return function(){var t=(s=this.data("marker")).markerShape,e=t.options,o=t.bounds,r=e._markerEventArgs,a=t.wrapper,i=t.fillOptions,n=(l=h.config.scalingParams).translateX,l=l.translateY,s=s.config;a&&e.hovereffect&&("circle"===t.type&&(t={color:e.hoverfillcolor,alpha:e.hoverfillalpha,angle:360-e.hoverfillangle,ratio:e.hoverfillratio,gradientUnits:"objectBoundingBox",radialGradient:i.radialGradient,cx:i.cx,cy:i.cy},e._hoverattrs.fill=O(t)),t=A({},e._hoverattrs),"image"===a.type&&(delete t.fill,delete t.stroke,delete t["stroke-width"]),a.attr(t)),r||(r=e._markerEventArgs={x:o.x1/o.xs,y:o.y1/o.ys,scaledX:o.x1,scaledY:o.y1,chartX:n+o.x1,chartY:l+o.y1,id:e._markerId,label:e._markerLabel}),C.raiseEventGroup(s.id,"markerRollOver",r,h.chartInstance,s,void 0,void 0,void 0)}},getHoverOutFn:function(){var i=this.chart;return function(){var t=(r=this.data("marker")).markerShape,e=t.wrapper,o=t.fillOptions,r=r.config,a=t.options;e&&t.options.hovereffect&&("circle"===t.type&&(a._defaultattrs.fill=O(o)),o=A({},t.options._defaultattrs),"image"===e.type&&(delete o.fill,delete o.stroke,delete o["stroke-width"]),e.attr(o)),C.raiseEventGroup(r.id,"markerRollOut",t.options._markerEventArgs,i.chartInstance,void 0,void 0,void 0)}},getClickFn:function(){var l=this;return function(t){var e=this.data("marker"),o=l.chart,r=(a=o.config.scalingParams).translateX,a=a.translateY,i=(e=(i=e.markerShape).options,i.bounds),n=e._markerEventArgs;n||(n=e._markerEventArgs={x:i.x1/i.xs,y:i.y1/i.ys,scaledX:i.x1,scaledY:i.y1,chartX:r+i.x1,chartY:a+i.y1,id:e._markerId,label:e._markerLabel}),C.raiseEvent("markerClick",n,o.chartInstance,t)}},highlightPoint:function(t){var e,o,r,a,i=t.element,n=this.chart,l=n.graphics,s=n.components.paper,h=l.trackerElems||(l.trackerElems={}),c=t.shapeInfo,d=t.x,p=t.y;e=n.config.lastHoveredPoint;var g=!1;!1===t?((h=h[e=e&&e.shapeInfo.type])&&h.hide(),n.config.lastHoveredPoint=null):("circle"===(e=c.type)&&(e="polygon"),h=h[e],"polygon"===e?(o=c.sides||1,r=c.startAngle,c=c.radius,h?h.attr({polypath:[o,d,p,c,r]}):(h=l.trackerElems[e]=s.polypath(o,d,p,c,r),g=!0)):"rect"===e?(r=c.width,c=c.height,h?h.attr({x:d,y:p,width:r,height:c}):(h=l.trackerElems[e]=s.rect(d,p,r,c),g=!0)):"arc"===e&&(o=i.markerShape.bounds.innerR,r=(a=i.markerShape.bounds.angles).start*u,a=a.end*u,c=c.radius,h?h.attr({ringpath:[d,p,c,o,r,a]}):(h=l.trackerElems[e]=s.ringpath(d,p,c,o,r,a),g=!0)),n.config.lastHoveredPoint=t,g&&(h.attr({fill:b,stroke:b}).click(this.getClickFn()).hover(this.getHoverFn(),this.getHoverOutFn()),h.trackTooltip(!0)),h.show().tooltip(i.config.tooltext).data("marker",i))},_drawConnectors:function(){var t,e,o,r,a,i=this.chart,n=this.components.connectors,l=n.length,s=i.config.scalingParams,h=i.config.connectorOpts,c=h.showLabels,d=i.components.mapAnnotations,p=[],g=[],u=[];for(u.push({id:"connectorLabels",fillalpha:"100",items:g}),u.push({id:"connectors",fillalpha:"100",items:p}),t=0;t<l;t++)n[t]&&(o=n[t].config.fromMarker.config,a=n[t].config.toMarker.config,e=o.options.x,o=o.options.y,r=a.options.x,a=a.options.y,n[t].config.x=e,n[t].config.y=o,n[t].config.tox=r,n[t].config.toy=a,p.push(n[t].config),n[t].labelConfig&&c&&(n[t].labelConfig.x=((Number(e)+Number(r))/2).toString(),n[t].labelConfig.y=((Number(o)+Number(a))/2).toString(),n[t].labelConfig.fontsize=h.fontSize/(s.scaleFactor*i.baseScaleFactor),g.push(n[t].labelConfig)));d.addGroup(u[0]),d.addGroup(u[1])},getShapeArgs:function(){var t,e=this.config,o=A({},this.shapeObj);return e.autoScale=1,o?("polygon"===o.type?o.sides<3?o.type="circle":o.startangle=e.startAngle:"arc"===o.type&&(t=(o.radius||e.markerRadius)*e.autoScale,o.radius=t,o.innerradius=o.innerradius&&o.innerradius*e.autoScale||.6*t),o):null},_getLabelOptions:function(t,e,o,r,a){var i,n=t&&t.toLowerCase();return this.getLabelAlignment[n]||(n="center"),t=Number(o.x),i=Number(o.y),o=void 0===r||void 0===a?o.radius||0:/^(top|bottom)$/gi.test(n)&&.5*a||/^(left|right)$/gi.test(n)&&.5*r||0,o=Number(o)+Number(e),this.getLabelAlignment[n](t,i,o)},getLabelAlignment:{top:function(t,e,o){return{x:t.toString(),y:(e-o).toString(),align:"center",valign:"top"}},left:function(t,e,o){return{x:(t-o).toString(),y:e.toString(),align:"right",valign:"middle"}},right:function(t,e,o){return{x:(t+o).toString(),y:e.toString(),align:"left",valign:"middle"}},bottom:function(t,e,o){return{x:t.toString(),y:(e+o).toString(),align:"center",valign:"bottom"}},center:function(t,e){return{x:t.toString(),y:e.toString(),align:"center",valign:"middle"}}},getWrapWidth:{right:function(t,e){return e},left:function(t,e){return t-e},center:function(t,e){return 2*y(e,t-e)}},getWrapHeight:{top:function(t,e){return e},middle:function(t,e){return 2*y(e,t-e)},bottom:function(t,e){return t-e}},addMarkerItem:function(t){var e,o,r=this.components.markerObjs,a=this.components.shapeObjs,i=this.components.markerGroup,n=this.components.markerLabelGroup;(o=t.id.toLowerCase())&&!r[o]&&(delete t.value,this.imageLoadCount=0,(t=this._initializeMarkerItem(o,t,null)).dataset=this,(e=t.config.options.shapeid)&&(t.shapeObj=a[e&&e.toLowerCase()]),r[o]=t,r=this._drawMarkerItem.call(t),i&&n&&(t.markerShape=r.markerShape&&i.addItem(r.markerShape,!0),t.markerLabel=r.markerLabel&&n.addItem(r.markerLabel,!0)),this._buildKdTree())},updateMarkerItem:function(t,e){var o,r=this.chart.components.mapAnnotations,a=this.components.markerObjs[t];a&&(o=a.config.options,A(o,e),this.imageLoadCount=0,o=this._drawMarkerItem.call(a).markerShape,this._buildKdTree(),r.update(t,o))},_removeMarkerItem:function(t){var e,o=(a=this.components).markerObjs,r=o[t],a=a.kdArrayMap;r&&(e=r.markerShape,r=r.markerLabel,e&&e.destroy(),r&&r.destroy(),delete a[t],this._buildKdTree()),delete o[t]},getElement:function(t){if(this.components.kDTree)return this.components.kDTree.getNeighbour(t)}},"Entities"])},[3,2,0,"release"]])});